/*	
 *	INTRO
 *	referral.js handles loading, initializing, and processing social job referrals via facebook, linkedin, and twitter
 *	
 *	USES
 *	Each job referral option is triggered via a specific global binding. Here are the available options:
 *	'statusUpdate': Opens the status update modal to share to multiple networks at once as a news feed item
 *	'linkedinMesage': Opens the linkedIn personal message modal to share a job directly with linkedIn contacts via personal message
 *	'facebookMessage': Opens the facebook personal message dialog (via facebook API) to share a job link via facebook personal message
 *	
 *	Each of these triggers will automatically handle verifying user state is compatible with loading the modal or redirecting to 
 *	register/login and then reloading the initial request once complete.
 *	
 *	
 *	DEPENDENCIES (plugins)
 *	jquery.autosize-min.js
 *	
 *	DEPENDENCIES (custom)
 *	desktop.js
 *	user.js
 *	modal.js
 *	
 */


(function(j$){

	var handleStatusUpdate = function(e,data) {
		data = data || {};
		j$.extend(data, { mode:"statusUpdate" });
		// if not registered open registration modal & set next
		if (TVAPP.user.getRegStatus() == "unregistered") {
			// set next action and redirect to register
			j$.log('-> Redirect to register');
			TVAPP.modal.proceed = false;
			TVAPP.modal.nextAction = function() { j$(document).trigger('statusUpdate',data); };
			j$(document).bind("userInfoUpdated.modal.status", function() {
				if(TVAPP.user.getRegStatus() != "unregistered") {
					j$.log('<- Reattempt status update');
					TVAPP.modal.proceed = true;
					TVAPP.modal.close();
					j$(document).unbind('.status');
				}
			});
			j$(document).trigger('registerModal', data);
		// finally open status update modal
		} else {
			TVAPP.modal.open('status_update_modal', {}, data);
		}
	};
	
	var handleStatusUpdateModalInitialize = function(e,data) {
		// tracking
		j$(document).trigger("trackEvent", { action: "Status Update", label: 'jReferAllContacts' });
		j$(document).trigger("trackPage", { url: "/ga/ajax/refer/StatusUpdate"});
		// vars
		var modal = j$('#cboxLoadedContent');

		// solves likely user & logged in user mismatch link length error
		j$('#url').val('##url##');
		
		// define function to update char counter if twitter is selected
		var updateCharCount = function() {
			var max = j$('#max_count').val(),
				body = j$('#message_body'),
				send = j$(".jSendMessage");
			if( j$("#twitter_checkbox").is(':checked') || j$("#weibo_checkbox").is(':checked') ) {
				j$('#counter').val(max - body.val().length);
				if (body.val().length > max){
					body.parent().addClass('warning');
					send.addClass('disabled');
				} else {
					body.parent().removeClass('warning');
					send.removeClass('disabled');
				}
			} else {
				body.parent().removeClass('warning');
				send.removeClass('disabled');				
			}
		};
		// bind function to all changes in message_body
		j$('.jMessageBody').bind("keyup keydown keypress change", updateCharCount);

		// Look up the message character limit (twitter only) based on the link length
		j$.ajax({
			type: "POST",
			url: TVAPP.guid("/ajax/char_count"),
			data: JSON.stringify(j$("#referral-form").serializeObject()),
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			success: function(data) {
				// define twitter max length
				j$("#max_count").val(data.Result.remaining_char_count);
				// update the tooltip
				var tooltip = j$('<span>').html(TVAPP.smDict('Refer.Message.TrackingLink.tooltip'));
				tooltip.find('.jLinkLength').text(data.Result.link_length);
				j$(".smpl_link").clickover({
					placement:'right',
					title:"link_tooltip",
					content:tooltip,
					html: true,
					animation:false
				});
				// update the character count
				updateCharCount();
			},
			error: function(xhr, textStatus, error) { TVAPP.masterErrorHandler(xhr, textStatus, error, null); }
		});

		// Bind social channel buttons
		refreshStatusBindings();

		// Bind Message Functionality
		j$('.message_body', modal).click(function(){
			j$('.jMessageBody', modal).focus();
		});
		j$(".jMessageBody").autosize();



		// Bind form submit functionality
		j$(".jSendMessage").bind("click", function(event){
			if(!j$(this).hasClass("disabled")) handleStatusUpdateSubmit(j$("#referral-form"));
		});
	};
	var refreshStatusBindings = function(e, data) {
		var modal = j$('#cboxLoadedContent');
		// if social status options is not open, do not load these bindings
		if(!j$('#social_status_options').length) return false;
		// Bind social channel buttons
		if(j$("#social_status_options a", modal).length) {
			j$("#social_status_options a", modal)
				.click(function(event){
					event.preventDefault();
					TVAPP.login[j$(this).attr('data-channel')]({click_event: event}); 
				})
				.each(function(){
					if (j$(this).hasClass("custom_tooltip")) {
						j$(this).tooltip({
							placement:'left', 
							title: TVAPP.smDict('SocialNetwork.TooltipText.'+j$(this).attr('data-channel'))
						});
					}
				});
		}

		// define function to update char counter display if necessary (& run it)
		var updateCharDisplay = function() {
			// temporarily disable the toggle while animating
			j$("#twitter_checkbox , #weibo_checkbox").attr("disabled", true);
			// make sure checkbox state matches char_counter state
			if( (j$("#twitter_checkbox").is(':checked') || j$("#weibo_checkbox").is(':checked')) && j$("#char_counter").is(':hidden')){
				j$.colorbox.resize({
					innerHeight: j$('#cboxLoadedContent').height()+j$('#char_counter').height()
				});
				j$("#char_counter").stop(true,true).show(350, function() { j$("#twitter_checkbox , #weibo_checkbox").removeAttr("disabled"); });
			} else if (!j$("#twitter_checkbox , #weibo_checkbox").is(':checked') && j$("#char_counter").is(':visible')) {
				j$.colorbox.resize({
					innerHeight: j$('#cboxLoadedContent').height()-j$('#char_counter').height()
				});
	   		 	j$("#char_counter").stop(true,true).hide(350, function() { j$("#twitter_checkbox , #weibo_checkbox").removeAttr("disabled"); });
			} else {
				j$.colorbox.resize();
				j$("#twitter_checkbox , #weibo_checkbox").removeAttr("disabled");
			}
			j$(".jMessageBody").trigger('change');
		};
		updateCharDisplay();
	
		// Add twitter checkbox toggle for character count
		j$("#twitter_checkbox , #weibo_checkbox").change(updateCharDisplay);

	};
	
	var handleStatusUpdateSubmit = function(theForm) {
		j$(document).trigger("trackEvent", { action: "Send Message", label: 'jReferAllContacts' });
		j$(document).trigger("trackPage", { url: "/ga/ajax/refer/SendMessage"});

		// Format Broadcast Channels correctly
		var broadcastChannels = new Array();
		j$('[name="Message.social_channels"]:checked', theForm).each(function() {
			broadcastChannels.push(j$(this).val());
		});
		j$("input[name='Message.broadcast_channels']").val( JSON.stringify(broadcastChannels) );

		// Add loading animation
		TVAPP.modal.loadingStart();
		
		// Post message form
		j$.ajax({
			type: 'POST',
			contentType: "application/json; charset=utf-8",
			url: TVAPP.guid(theForm.attr('action')),
			data: JSON.stringify(theForm.serializeObject()),
			contentType: "application/json; charset=utf-8",
			dataType: 'json',
			success: function(result) { 
				if(result.Status == "OK") {
					var userMessage = result.UserMessage;
					j$("body").modal({
						"text":userMessage,
						"onClose": function() { TVAPP.modal.close(); }
					});
				} else {
					j$.log(result.Errors.GENERIC_ERROR_STRING);
				}
			},
			error: function(xhr, textStatus, error) { TVAPP.masterErrorHandler(xhr, textStatus, error, null); },
			complete: function() { 
				TVAPP.modal.loadingStop();
			}
		});
	};

	j$(document).bind('statusUpdate', handleStatusUpdate);
	j$(document).bind('status_update_modal_init', handleStatusUpdateModalInitialize);
	j$(document).bind("refreshUserBindings",refreshStatusBindings);
	
	var handleLinkedinMessage = function(e, data) {
		data = data || {};
		j$.extend(data, { mode:"linkedinMessage", available_channels:TVAPP.user.getAuthenticatedChannels() });
		// if not registered open registration modal & set next
		if (TVAPP.user.getRegStatus() == "unregistered") {
			// set next action and redirect to register
			j$.log('-> Redirect to register');
			TVAPP.modal.proceed = false;
			TVAPP.modal.nextAction = function() { j$(document).trigger('linkedinMessage',data); };
			j$(document).bind("userInfoUpdated.modal.linkedin", function() {
				if(TVAPP.user.getRegStatus() != "unregistered") {
					j$.log('<- Reattempt linkedin message');
					TVAPP.modal.proceed = true;
					TVAPP.modal.close();
					j$(document).unbind('.linkedin');
				}
			});
			j$(document).trigger('registerModal', data);
		// if linkedin not tethered open Auth dialog IMMEDIATE ONLY
		} else if (j$.inArray('linkedin',data.available_channels) == -1 && TVAPP.modal.state == 'closed') {
			// set next action and open LinkedIn authentication
			j$.log('-> Redirect to linkedin auth');
			TVAPP.modal.proceed = false;
			TVAPP.modal.nextAction = function() { j$(document).trigger('linkedinMessage',data); };
			j$(document).bind("userInfoUpdated.modal.linkedin", function() {
				j$.log('<- Reattempt linkedin message');
				TVAPP.modal.proceed = true;
				TVAPP.modal.close();
				j$(document).unbind('.linkedin');
			});
			TVAPP.login.linkedin(j$.extend(data, {method:"default"}));
		// if linkedin not tethered and modal already open we must initiate a new click event to avoid pop-up blockers
		} else if (j$.inArray('linkedin',data.available_channels) == -1) {
			j$("body").modal({
				"text": TVAPP.smDict("Refer.Modal.LinkedIn.auth_message"),
				"onClose": function() {
					// set next action and open LinkedIn authentication
					j$.log('-> Redirect to linkedin auth');
					TVAPP.modal.proceed = false;
					TVAPP.modal.nextAction = function() { j$(document).trigger('linkedinMessage',data); };
					j$(document).bind("userInfoUpdated.modal.linkedin", function() {
						j$.log('<- Reattempt linkedin message');
						TVAPP.modal.proceed = true;
						TVAPP.modal.close();
						j$(document).unbind('.linkedin');
					});
					// registration form is still visible (even though complete), 
					// make sure that it is closed under different end flow scenarios
					j$(document).bind('channelAuthCancelled.modal.linkedin', function(data) {
						j$.log('<- Auth Cancelled, Close Modal');
						TVAPP.modal.close();
						j$(document).unbind('.linkedin');
					});
					j$(document).bind('channelAuthConflict.modal.linkedin', function(data) {
						j$.log('<- Auth Conflict, Close Modal');
						TVAPP.modal.close();
						j$(document).unbind('.linkedin');
					});
					
					TVAPP.login.linkedin(j$.extend(data, {method:"default"}));
				}
			});
		// finally open linkedin message modal
		} else {
			TVAPP.modal.open('linkedin_message_modal', {}, data);
		}
	};
	
	var handleLinkedinMessageModalInitialize = function(e, data) {
		
		// tracking
		if(!TVAPP.isEmpty(data.suggestion)) {
			j$(document).trigger("trackEvent", { action: "Send Message From Suggested Promo", label: 'jSugConRow' });
			j$(document).trigger("trackPage", { url: "/ga/ajax/refer/SendMessageFromSuggestedPromo"});
		} else {
			j$(document).trigger("trackEvent", { action: "Send Message", label: 'jReferSomeContacts' });
			j$(document).trigger("trackPage", { url: "/ga/ajax/refer/SendMessage"});
		}

		// vars
		var modal = j$('#cboxLoadedContent');
		var contacts = new Array();
		var contactsList; // api for jspScroller

		// Bind form submit functionality
		j$(".jSendMessage", modal).bind("click", function(event){
			handleLinkedInMessageSubmit(j$("#referral-form"), contacts);
		});
		
		// Bind Message Functionality
		j$('.message_body', modal).click(function(){
			j$('.jMessageBody', modal).focus();
		});
		
		// Initialize jScrollPane
		var pane = j$('.jSuggestedHolder');
		pane.jScrollPane({
			showArrows: false,
			animateScroll: true,
			trackClickSpeed: 1,
			clickOnTrack: true,
			animateEase: 'swing',
			animateDuration: 200,
			hideFocus: true,
			verticalGutter: 0,
			verticalDragMinHeight: 20
		}).bind('jsp-scroll-y', function() {
			j$('.jContactSearch', modal).popover('destroy');
			j$('.jContactAdd.active', modal).removeClass('active');
			if(j$(".jLoadMore").length && readyForMore) {
				if(isScrolledIntoView(j$(".jLoadMore"))) {
					readyForMore = false;
					loadMoreContacts();
				}
			}
		});
		contactsList = pane.data('jsp');

		j$(document).bind('contactListUpdated', function() {
			// update the jScrollPane
			contactsList.reinitialise();
			// Add slide to snap on drag
			j$('.jspDrag').mousedown(function(e) {
				j$(document).one('mouseup.jspSnap', function() {
					slideToSnap();
					j$(document).unbind('.jspSnap');
				});
				return false;
			});
		});
		// bind mousewheel slide to snap
		var snapTimer;
		j$('.jspContainer').bind('mousewheel', function(event) {
			clearTimeout(snapTimer);
			snapTimer = setTimeout(function(){
				slideToSnap();
			}, 300);
		});
		
		// Define Slide to Snap action
		function slideToSnap() {
			var prevPos = 0, currPos = contactsList.getContentPositionY(), dest;
			contactsList.getContentPane().find('.snap:visible').each(function(index, elem) {
				if(j$(elem).position().top > currPos) {
					dest = (currPos-prevPos >= j$(elem).position().top-currPos)? j$(elem).position().top : prevPos;
					contactsList.scrollToY(parseInt(dest));
					return false;
				}
				else {
					prevPos = j$(elem).position().top;
				}
			});
		}
		
		// Bind a click within the "To:" field to focus on the contact search field
		j$('#message-recipients').click(function(event){
			j$('.jSearchContacts').focus();
		});
		
		// Set the message character counts based on the link length
		j$('#url').val(window.location.protocol+'//'+window.location.hostname+window.location.pathname);
		j$.ajax({
			type: "POST",
			url: TVAPP.guid("/ajax/char_count"),
			data: JSON.stringify(j$("#referral-form").serializeObject()),
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			success: function(data) {
				j$("#max_count").val(data.Result.remaining_char_count);
				j$("#link_length").val(data.Result.link_length);
				var tooltip = j$('<span>').html(TVAPP.smDict('Refer.Message.TrackingLink.tooltip'));
				tooltip.find('.jLinkLength').text(data.Result.link_length);
				j$(".smpl_link").clickover({
					placement:'right',
					title:"link_tooltip",
					content:tooltip,
					html: true,
					animation:false,
					onShown: function() {
						j$('.jLinkLength', '.link_tooltip').text(data.Result.link_length);
					}
				});
			},
			error: function(xhr, textStatus, error) { TVAPP.masterErrorHandler(xhr, textStatus, error, null); }
		});

		// add search contacts functionality
		j$(".jContactSearchSubmit", modal).bind("click",function(event){
			j$('.jSearchContacts', modal).refercomplete("close");
			j$('.jContactSearch', modal).popover('destroy');
			// remove any previous search results
			contactsList.getContentPane().find('.jSuggestWrap').nextAll().remove();
			// add spinner
			contactsList.getContentPane().append("<div id='contact_spinner' />");
			j$('#contact_spinner').spin({
				lines: 13, // The number of lines to draw
				length: 6, // The length of each line
				width: 2, // The line thickness
				radius: 5, // The radius of the inner circle
				color: '#555' // #rgb or #rrggbb
			});
			// collapse suggested contacts
			if(!j$('.jSuggestToggle').hasClass('collapsed')) {
				j$('.jSuggestToggle').click();
			} else {
				contactsList.reinitialise();	
			}
			var params = {
				keywords:(j$(".jSearchContacts").val() == j$(".jSearchContacts").attr("placeholder") ? '' : j$(".jSearchContacts").val()),
				social_channels:'["linkedin"]'
			};
			j$.ajax({
				type: 'POST',
				url: TVAPP.guid('/ajax/search-contacts'),
				data: params,
				success: function(response){
					createUserSearchResults(response.Result,params.keywords);
				},
				dataType: 'json',
				error: function(xhr, textStatus, error) { TVAPP.masterErrorHandler(xhr, textStatus, error, null); },
				complete: function() { }
			});
		});
		// parse search results
		var createUserSearchResults = function(result,keywords){
			contactsList.getContentPane().append('<div id="jContactSearchTitle" class="section_title snap">'+TVAPP.smDict('global.search_results')+'</div>');
			contactsList.getContentPane().append(result); // append new search results
			// remove spinner
			j$('#contact_spinner').slideUp(400, function() {
				j$('#contact_spinner').remove();
				j$(document).trigger('contactListUpdated');
			});
			// update pagination variables
			j$('#jKeywords').val(keywords);
			j$('.jKeywords', modal).text(keywords);
			j$("input[name='page_index']").val(1);
			j$("input[name='num_pages']").val(parseInt(j$("input[name='num_pages_init']").val())); //set initial number of pages
			j$('#jContactSearchTitle').prepend('<span class="num_results">('+parseInt(j$("input[name='num_results_init']").val())+')</span>');
			// add pagination loading div if needed
			if( parseInt(j$("input[name='num_pages']").val()) > 1 ) {
				contactsList.getContentPane().append("<div class='jLoadMore'></div>");
				j$('.jLoadMore').spin();
			}
			j$(document).trigger('contactListUpdated'); // linkedin contacts search ie fix
		};

		var resetPopover = function(){
			j$('.jContactSearch', modal).popover('destroy');
			j$('.jContactAdd.active').removeClass('active');
			j$('body').unbind('.popover');			
		};

		j$(document).bind('contactListUpdated', function() {
			j$('.jContactSearch', modal).popover('destroy');
			j$(".jContactAdd", modal).not('.processed').each(function() {
				j$(this).bind("click",function(){
					pushSuggestedContact(j$(this).find('.jContactValues').val());
				});
				//display Contact popOver for desktop only
				if (!j$("body").hasClass("mobile")) {
					j$(this).find(".jHideInfo").bind("click",function(event){
						event.stopPropagation();
						resetPopover();
					});
					j$(this).find(".jShowInfo").bind("click",function(event){
						event.stopPropagation();
						elem = event.currentTarget;
						j$(this).parent('.jContactAdd').addClass('active').siblings().removeClass('active');
						if(j$('.link_tooltip', modal).length) j$('.smpl_link').clickover('forcehide');
						j$('.jContactSearch', modal).popover('destroy').popover({
							placement:'right',
							title:"contact_detail_pop",
							content:j$(elem).siblings(".jContactDetail").html(),
							html: true,
							trigger: 'manual',
							animation:false			
						}).popover('show');				
						var ypos = j$(elem).parent('.jContactAdd').position().top + 113 - contactsList.getContentPositionY();
						j$('.contact_detail_pop .arrow').css({top:ypos});
						j$(".jDetailContactAdd", modal).unbind('click').bind("click",function(){
							pushSuggestedContact(j$(".jContactAdd.active").first().find('.jContactValues').val());
							j$(".jContactAdd.active .jHideInfo").click();
						});
						j$('.jClosePopover', modal).bind("click",function(){
							event.stopPropagation();
							resetPopover();
						});
						j$('body').bind('click.popover', function(e) {
							if ( !j$('.contact_detail_pop').has(e.target).length ) { 
								resetPopover();
							}
						});
					});
				}

				j$(this).addClass('processed');
			});

		});

		// initialize default suggested contacts
		j$("#suggestions").spin({
			lines: 13, // The number of lines to draw
			length: 6, // The length of each line
			width: 2, // The line thickness
			radius: 5, // The radius of the inner circle
			color: '#555' // #rgb or #rrggbb
		});
		j$.ajax({
			type: 'POST',
    		url: TVAPP.guid("/ajax/content/suggested_contacts?Job.id="+data.job_id),
    		dataType: 'json',
    		timeout: 10000,
    		success: function(response) {
				contactsList.getContentPane().html(response.Result);
				bindSuggestToggle();
        		j$(document).trigger('contactListUpdated');
    		},
   	 		error: function(xhr, textStatus,error) {
				TVAPP.masterErrorHandler(xhr, textStatus, error, null);
    		}
		});
		var bindSuggestToggle = function() {
			j$('.jSuggestToggle').click(function(){
				j$(this).toggleClass('collapsed');
				var toggle = j$(this).find('.toggle');
				toggle.toggleClass('down-arrow up-arrow');
				toggle.hasClass('down-arrow') ? toggle.html(TVAPP.smDict('entypo.chevron_down')) : toggle.html(TVAPP.smDict('entypo.chevron_up'));
				contactsList.getContentPane().find('.jSuggestWrap').stop(true,true).slideToggle(400, function(){
					contactsList.reinitialise();
				});
			});
		};
		
		// handle resize events
		var resizeMessage = function() {
			// resize message box if needed
			if (j$('.jContactSearch').outerHeight(true) != j$('.jReferCustomize').outerHeight(true) && !j$("body").hasClass("mobile")) {
				j$('.message_body').height(function (i, h) {
					return h+j$('.jContactSearch').outerHeight(true)-j$('.jReferCustomize').outerHeight(true);
				});
			}
			j$.colorbox.resize();	
		};
		
		// handle adding contact to recipient list
		var pushSuggestedContact = function(contact_values) {
			var parsed_values = j$.extend(JSON.parse(contact_values),{"site_standard_profile_url":""}); // Needed? - JD
			var contact_exists = false;
			j$(contacts).each(function() {
				if(this.channel_user_id==parsed_values.channel_user_id && this.channel_short_name==parsed_values.channel_short_name) {
					contact_exists = true;
				}
			});
			if(!contact_exists) {
				var contact_pill = j$("<span class='contact'>"+parsed_values.label+" <a id='"+parsed_values.channel_user_id+"' href='#' class='jAutoDelete'>&times;</a></span>");
				contact_pill.children('.jAutoDelete').click(function(event){
					event.preventDefault();
					event.stopPropagation();
					j$(contacts).each(function (i, e) {
						if(j$(event.currentTarget).attr("id") == e.channel_user_id) {
							contacts.splice(i,1);
						}
					});
					j$(event.currentTarget).parents(".contact").remove();
					resizeMessage();
				});
				j$(".jContactsList").append(contact_pill);
				contacts.push(parsed_values);
				// Make sure contact pills don't propogate the click to the container
				j$(".jContactsList .contact").unbind('click').bind('click',function(e) {
					var event = e || window.event;
					event.stopPropagation();
				});
			}
			resizeMessage();
		};

		if(!TVAPP.isEmpty(data.suggestion)) {
			pushSuggestedContact(data.suggestion);
		}
	
		// customize search autocomplete
		j$.widget( "custom.refercomplete", j$.ui.autocomplete, {
			_renderItem: function( ul, item ) {
				if(!j$(ul).hasClass("ref-autocomplete")) {
					j$(ul).addClass("ref-autocomplete");
				}

				j$(".jSuggestedHolder").css("opacity","0.25");

				var avatar = (item.avatar != "") ? item.avatar : "/images/avatar_placeholder.jpg";
				var label = (item.label != "") ? item.label : "";

				var channel_short_name = (item.channel_short_name != "") ? item.channel_short_name : "";

				var headline = (item.headline != "") ? item.headline : "";

				if (j$("body").hasClass("mobile") && headline.indexOf(" at " === -1)) {
					var headlineMobile = headline.split(" at ").join('<br>at ');
					headline = headlineMobile;
				}
				
				var tmp = j$( '<li class="li_contact"></li>')
					.append( "<a href='#'><img src='" + avatar + "' class='avatar_img' />" + label + "<br /><span class='contact_job_title'>" + headline + "</span></a>" );
				
				tmp.data( "ui-autocomplete-item", item ).appendTo( ul );
				
				return tmp;	
					
			}
		});

		// add search autocomplete
		j$('#jLiContacts', modal)
			.refercomplete({
				minLength: 2,
				appendTo: '.jContactSearch',
				source: function(request, response) {
					// delegate back to autocomplete, but extract the last term
					var terms = request.term.split(/,\s*/),
						last = terms.pop(),
						INcontacts = new Array();
					j$.log("REQUEST: " + JSON.stringify(last));
					// filter contacts to only be linkedin contacts
					j$.each(TVAPP.user.getContacts(), function(idx, result) {
						if(result.channel_short_name == "linkedin") {
							INcontacts.push(result);
						}
					});
					
					j$.log("LinkedIn Suggest Object: " + JSON.stringify(INcontacts));
					
					var results = j$.ui.autocomplete.filter(INcontacts, last);
					response(results.slice(0,4));
					
					j$.log("Serialized Suggest Object: " + JSON.stringify(results));
					
				},
				focus: function(event, ui) {
					return false;
				},
				select: function(event, ui) {
					event.preventDefault();
					j$(".jSuggestedHolder").css("opacity","1.0");
					pushSuggestedContact(JSON.stringify(ui.item));
					return false;
				}
			});
			
		// submit form with enter
		j$('.jSearchContacts', modal)
			.keydown(function(e) {
				if(e.which == 13 && !j$(".ui-state-hover").length) {
					j$(this).blur().focus();
					j$(".jSuggestedHolder").css("opacity","1.0");
					j$(".jContactSearchSubmit").trigger("click");
				}
			})
			.blur(function(){
				j$(".jSuggestedHolder").css("opacity","1.0");
			});

		// textarea autosize		
		j$(".jMessageBody").autosize();

		// add contacts infinite scroll functionality
		var readyForMore = true;
		function loadMoreContacts() {
			var pageIndex = parseInt(j$("input[name='page_index']").val());
			if( pageIndex < parseInt(j$("input[name='num_pages']").val())) {
				var params = {keywords:j$('#jKeywords').val(),social_channels:'["linkedin"]',page_index:pageIndex+1};
				j$.ajax({
					type: 'POST',
					url: TVAPP.guid('/ajax/search-contacts'),
					data: j$.param(params),
					success: function(response){
						j$(".jLoadMore").remove();
						contactsList.getContentPane()
							.append(response.Result)
							.append("<div class='jLoadMore'></div>");
						j$('.jLoadMore').spin();
						j$('.jKeywords', modal).text(params.keywords);
						j$("input[name='page_index']").val(pageIndex+1);
						readyForMore = true;
						j$(document).trigger('contactListUpdated');
					},
					dataType: 'json',
					error: function(xhr, textStatus, error) { TVAPP.masterErrorHandler(xhr, textStatus, error, null); }
				});
			} else {
				j$(".jLoadMore").remove();
				readyForMore = true;
				j$(document).trigger('contactListUpdated');
			}
		}
	
		function isScrolledIntoView(elem) {
		    var docViewTop = j$(window).scrollTop();
		    var docViewBottom = docViewTop + j$(window).height();
		    var elemTop = j$(elem).offset().top;
		    var elemBottom = elemTop + j$(elem).height();
		    return ((elemBottom >= docViewTop) && (elemTop <= docViewBottom));
		}
		
	};
	
	var handleLinkedInMessageSubmit = function(theForm, contacts) {
		j$(document).trigger("trackEvent", { action: "Send Message", label: 'jReferSomeContacts' });
		j$(document).trigger("trackPage", { url: "/ga/ajax/refer/SendMessage"});

		j$("input[name='Message.contacts']").val( JSON.stringify(contacts) );

		// Add loading animation
		TVAPP.modal.loadingStart();
		
		// Post message form
		j$.ajax({
			type: 'POST',
			contentType: "application/json; charset=utf-8",
			url: TVAPP.guid(theForm.attr('action')),
			data: JSON.stringify(theForm.serializeObject()),
			contentType: "application/json; charset=utf-8",
			dataType: 'json',
			success: function(result) { 
				if(result.Status == "OK") {
					var userMessage = result.UserMessage;
					j$("body").modal({
						"text":userMessage,
						"onClose": function() { TVAPP.modal.close(true); }
					});
				} else {
					j$.log(result.Errors.GENERIC_ERROR_STRING);
				}
			},
			error: function(xhr, textStatus, error) { TVAPP.masterErrorHandler(xhr, textStatus, error, null); },
			complete: function() { 
				TVAPP.modal.loadingStop();
			}
		});
	};

	j$(document).bind('linkedinMessage', handleLinkedinMessage);
	j$(document).bind('linkedin_message_modal_init', handleLinkedinMessageModalInitialize);

	var handleFacebookMessage = function(e, data) {
		data = data || {};
		j$.extend(data, { mode:"facebookMessage" });
		// if not registered open registration modal & set next
		if (TVAPP.user.getRegStatus() == "unregistered") {
			// set next action and redirect to register
			j$.log('-> Redirect to register');
			TVAPP.modal.proceed = false;
			TVAPP.modal.nextAction = function() { j$(document).trigger('facebookMessage',data); };
			j$(document).bind("userInfoUpdated.modal.facebook", function() {
				if(TVAPP.user.getRegStatus() != "unregistered") {
					j$.log('<- Reattempt facebook message');
					TVAPP.modal.proceed = true;
					TVAPP.modal.close();
					j$(document).unbind('.facebook');
				}
			});
			j$(document).trigger('registerModal', data);
		// open facebook message dialog
		} else {
			TVAPP.user.updateReferrerCodePrefix(function(){
				j$(document).trigger('facebookSendDialog', data);
			});
		}
	};
	
	var handleFacebookSendDialog = function(e,data) {
		data = data || {};
		TVAPP.modal.close(true); // since we are doing facebook in the native FB dialog modal
		j$.log('Open Facebook Message Dialog: '+TVAPP.property.site_name+TVAPP.property.referrer_code_prefix+'/jobs/'+data.job_id);
		if(FB){
			FB.ui({
				method: 'send',
				name: j$('meta[property="og\\:title"]').attr("content"),
				description: j$('meta[property="og\\:description"]').attr("content"),
				picture: j$('link[rel="image_src"]').attr("href"),
				link: (TVAPP.property.demo_mode ? TVAPP.property.demo_url+'/jobs/23716' : TVAPP.property.site_name+TVAPP.property.referrer_code_prefix+'/jobs/'+data.job_id),
				show_error: 'true'
			},
			function(response) {
				response = response || {}; // avoid error for closing
				if (response.success) {
					j$(document).trigger("trackEvent", { action: "Send Message", label: 'jReferSomeContacts' });
					j$(document).trigger("trackPage", { url: "/ga/ajax/refer/SendMessage"});
					// trigger action to add this share to activity feed and analytics tracking
					j$.post(
						TVAPP.guid("/ajax/jobs/"+data.job_id+"/refer"),
						{ "Message.mode":"personal_message", "Message.broadcast_channels":"['facebook']"},
						'json'
					);
					j$("body").modal({
						"text":TVAPP.smDict('Refer.Modal.Facebook.success')
					});
				} else {
					j$.log('Facebook Message Cancelled');
				}
			});
		} else {
			TVAPP.facebook_loading();
		}
	};

	j$(document).bind('facebookMessage', handleFacebookMessage);
	j$(document).bind('facebookSendDialog', handleFacebookSendDialog);
	
	
	
	var handleWeiboStatusUpdate = function(e, data) {
		data = data || {};
		j$.extend(data, { mode:"weiboMessage", registrationType:"weibo" });
		// if not registered open registration modal & set next
		if (TVAPP.user.getRegStatus() == "unregistered") {
			// set next action and redirect to register
			j$.log('-> Redirect to register');
			TVAPP.modal.proceed = false;
			TVAPP.modal.nextAction = function() { j$(document).trigger('weiboStatus',data); };
			j$(document).bind("userInfoUpdated.modal.weibo", function() {
				if(TVAPP.user.getRegStatus() != "unregistered") {
					j$.log('<- Reattempt weibo message');
					TVAPP.modal.proceed = true;
					TVAPP.modal.close();
					j$(document).unbind('.weibo');
				}
			});
			j$(document).trigger('registerModal', data);
		// open facebook message dialog
		} else {
			TVAPP.user.updateReferrerCodePrefix(function(){
				j$(document).trigger('weiboStatusDialog', data);
			});
		}
	};
	
	var handleWeiboStatusDialog = function(e,data) {
		data = data || {};
		TVAPP.modal.open("weibo_status_modal", {}, data);
	};
	
	var handleWeiboStatusInitialize = function(e,data) {
		data = data || {};
		var modal = j$('#cboxLoadedContent');
		
		//Beware all ye who enter - Weibo breaks out of iframes - Evan
		/*TVAPP.modal.open('weibo_status_redirect', {width:"840px", height:"840px", innerWidth: this.width, innerHeight:this.height+44, maxWidth:false, scrolling:true}, {url: status_url, iframeHeight:this.height});*/
		
		var current_url = encodeURIComponent(TVAPP.property.site_name+TVAPP.property.referrer_code_prefix+'/jobs/'+data.job_id);
		
		j$.getJSON("/ajax/links/refer",{
			"url":'/jobs/'+data.job_id,
			"social_channel_name":"weibo"
		}, function(data){
			current_url = data.UserMessage;
		});
		
		j$(".jWeiboStatusLaunch",modal).click(function(e){
			TVAPP.modal.close(true); // since we are doing facebook in the native FB dialog modal
			j$.log('Open Weibo Status Dialog: '+TVAPP.property.site_name+TVAPP.property.referrer_code_prefix+'/jobs/'+data.job_id);
			
			//var status_url = "http://service.weibo.com/share/share.php?url=" + encodeURIComponent(current_url) + "&title=" + encodeURIComponent(j$('meta[property="og\\:title"]').attr("content"));
			var status_url = "http://service.weibo.com/share/share.php?url=" + encodeURIComponent(current_url) + "&title=" + encodeURIComponent(TVAPP.smDict("Refer.Weibo.lite.message"));
			
			j$(document).trigger("trackEvent", { action: "Status Update", label: 'jStatusWeibo' });
			j$(document).trigger("trackPage", { url: "/ga/ajax/refer/StatusWeibo"});
			
			//Window Version ->
			var currWinX = (document.all) ? window.screenLeft : window.screenX;
			var currWinY = (document.all) ? window.screenTop : window.screenY;
			currWinX += 240;
			currWinY += 275;
			window.open(
				status_url, "tether", "width="+ 651 +", height="+ 399 +", toolbar=no, resizable=yes, "+
				"location=no, directories=no, status=no, menubar=no, copyhistory=no, " +
				"left="+ currWinX +", top="+ currWinY +", screenX="+ currWinX +", screenY="+ currWinY
			);
		});
	};
	
	
	j$(document).bind('weiboStatus', handleWeiboStatusUpdate);
	j$(document).bind('weiboStatusDialog', handleWeiboStatusDialog);
	j$(document).bind('weibo_status_modal_init', handleWeiboStatusInitialize);
	
	
	/* -- Remove, added global binding in desktop.js
	var handleReferralLink = function(e,data) {
		data = data || {};
		j$.extend(data, { mode:"referralLink" });
		// if likely unregistered open registration modal & set next
		if (TVAPP.user.getIsGuest() == 'true' && TVAPP.user.likelyUser.getIsGuest() == 'true') { // partially logged in is ok
			// set next action and redirect to register
			j$.log('-> Redirect to register');
			TVAPP.modal.proceed = false;
			TVAPP.modal.nextAction = function() { j$(document).trigger('referralLink',data); };
			j$(document).bind("userInfoUpdated.modal.link", function() {
				if(TVAPP.user.getRegStatus() != "unregistered") {
					j$.log('<- Reattempt referral link');
					TVAPP.modal.proceed = true;
					TVAPP.modal.close();
					j$(document).unbind('.link');
				}
			});
			j$(document).trigger('registerModal', data);
		// else load referal link modal
		} else {
			TVAPP.modal.open('referral_link_modal', {}, data);
		}
	};

	var handleReferralLinkModalInitialize = function(e,data) {
		// tracking
		j$(document).trigger("trackEvent", { action: "Grab The Link", label: 'jClipModalOpen' });
		j$(document).trigger("trackPage", { url: "/ga/ajax/refer/GrabTheLink"});

		// local variables
		var modal = j$('#cboxLoadedContent'),
			shortUrl = '',
			ref_clip = new ZeroClipboard.Client();

		// Update Referral Link
		j$.post(
			TVAPP.guid('/ajax/job_short_url'),
			{ "Job.id" : data.job_id },
			function(result) {
				if(result.Status == "OK") {
					shortUrl = result.Result.job_short_url.toString();
					ref_clip.setText(shortUrl);
					j$(".jShortLink",modal).val(shortUrl);
					ref_clip.glue(j$('.jCopyBtn',modal)[0], j$('.jCopyBtn',modal).parent()[0]);
				} else {
					shortUrL = result.Error.GeneralError;
				}
			},
			'json'
		);

		// Add zeroclipboard copy link callback
		ref_clip.addEventListener( 'onComplete', 
			function(client, text) {
				j$.log("Copied link to clipboard: " + text );
				j$("body").modal({
					"text":TVAPP.smDict('Refer.Modal.Link.success'), 
					onClose: TVAPP.modal.close(true)
				});
			}
		);

	};

	j$(document).bind('referralLink', handleReferralLink);
	j$(document).bind('referral_link_modal_init', handleReferralLinkModalInitialize);
	---- */

})(jQuery);         20190128165852                                                Œ      / * 	 
   * 	 I N T R O 
   * 	 r e f e r r a l . j s   h a n d l e s   l o a d i n g ,   i n i t i a l i z i n g ,   a n d   p r o c e s s i n g   s o c i a l   j o b   r e f e r r a l s   v i a   f a c e b o o k ,   l i n k e d i n ,   a n d   t w i t t e r 
   * 	 
   * 	 U S E S 
   * 	 E a c h   j o b   r e f e r r a l   o p t i o n   i s   t r i g g e r e d   v i a   a   s p e c i f i c   g l o b a l   b i n d i n g .   H e r e   a r e   t h e   a v a i l a b l e   o p t i o n s : 
   * 	 ' s t a t u s U p d a t e ' :   O p e n s   t h e   s t a t u s   u p d a t e   m o d a l   t o   s h a r e   t o   m u l t i p l e   n e t w o r k s   a t   o n c e   a s   a   n e w s   f e e d   i t e m 
   * 	 ' l i n k e d i n M e s a g e ' :   O p e n s   t h e   l i n k e d I n   p e r s o n a l   m e s s a g e   m o d a l   t o   s h a r e   a   j o b   d i r e c t l y   w i t h   l i n k e d I n   c o n t a c t s   v i a   p e r s o n a l   m e s s a g e 
   * 	 ' f a c e b o o k M e s s a g e ' :   O p e n s   t h e   f a c e b o o k   p e r s o n a l   m e s s a g e   d i a l o g   ( v i a   f a c e b o o k   A P I )   t o   s h a r e   a   j o b   l i n k   v i a   f a c e b o o k   p e r s o n a l   m e s s a g e 
   * 	 
   * 	 E a c h   o f   t h e s e   t r i g g e r s   w i l l   a u t o m a t i c a l l y   h a n d l e   v e r i f y i n g   u s e r   s t a t e   i s   c o m p a t i b l e   w i t h   l o a d i n g   t h e   m o d a l   o r   r e d i r e c t i n g   t o   
   * 	 r e g i s t e r / l o g i n   a n d   t h e n   r e l o a d i n g   t h e   i n i t i a l   r e q u e s t   o n c e   c o m p l e t e . 
   * 	 
   * 	 
   * 	 D E P E N D E N C I E S   ( p l u g i n s ) 
   * 	 j q u e r y . a u t o s i z e - m i n . j s 
   * 	 
   * 	 D E P E N D E N C I E S   ( c u s t o m ) 
   * 	 d e s k t o p . j s 
   * 	 u s e r . j s 
   * 	 m o d a l . j s 
   * 	 
   * / 
 
 
 ( f u n c t i o n ( j $ ) { 
 
 	 v a r   h a n d l e S t a t u s U p d a t e   =   f u n c t i o n ( e , d a t a )   { 
 	 	 d a t a   =   d a t a   | |   { } ; 
 	 	 j $ . e x t e n d ( d a t a ,   {   m o d e : " s t a t u s U p d a t e "   } ) ; 
 	 	 / /   i f   n o t   r e g i s t e r e d   o p e n   r e g i s t r a t i o n   m o d a l   &   s e t   n e x t 
 	 	 i f   ( T V A P P . u s e r . g e t R e g S t a t u s ( )   = =   " u n r e g i s t e r e d " )   { 
 	 	 	 / /   s e t   n e x t   a c t i o n   a n d   r e d i r e c t   t o   r e g i s t e r 
 	 	 	 j $ . l o g ( ' - >   R e d i r e c t   t o   r e g i s t e r ' ) ; 
 	 	 	 T V A P P . m o d a l . p r o c e e d   =   f a l s e ; 
 	 	 	 T V A P P . m o d a l . n e x t A c t i o n   =   f u n c t i o n ( )   {   j $ ( d o c u m e n t ) . t r i g g e r ( ' s t a t u s U p d a t e ' , d a t a ) ;   } ; 
 	 	 	 j $ ( d o c u m e n t ) . b i n d ( " u s e r I n f o U p d a t e d . m o d a l . s t a t u s " ,   f u n c t i o n ( )   { 
 	 	 	 	 i f ( T V A P P . u s e r . g e t R e g S t a t u s ( )   ! =   " u n r e g i s t e r e d " )   { 
 	 	 	 	 	 j $ . l o g ( ' < -   R e a t t e m p t   s t a t u s   u p d a t e ' ) ; 
 	 	 	 	 	 T V A P P . m o d a l . p r o c e e d   =   t r u e ; 
 	 	 	 	 	 T V A P P . m o d a l . c l o s e ( ) ; 
 	 	 	 	 	 j $ ( d o c u m e n t ) . u n b i n d ( ' . s t a t u s ' ) ; 
 	 	 	 	 } 
 	 	 	 } ) ; 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' r e g i s t e r M o d a l ' ,   d a t a ) ; 
 	 	 / /   f i n a l l y   o p e n   s t a t u s   u p d a t e   m o d a l 
 	 	 }   e l s e   { 
 	 	 	 T V A P P . m o d a l . o p e n ( ' s t a t u s _ u p d a t e _ m o d a l ' ,   { } ,   d a t a ) ; 
 	 	 } 
 	 } ; 
 	 
 	 v a r   h a n d l e S t a t u s U p d a t e M o d a l I n i t i a l i z e   =   f u n c t i o n ( e , d a t a )   { 
 	 	 / /   t r a c k i n g 
 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k E v e n t " ,   {   a c t i o n :   " S t a t u s   U p d a t e " ,   l a b e l :   ' j R e f e r A l l C o n t a c t s '   } ) ; 
 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k P a g e " ,   {   u r l :   " / g a / a j a x / r e f e r / S t a t u s U p d a t e " } ) ; 
 	 	 / /   v a r s 
 	 	 v a r   m o d a l   =   j $ ( ' # c b o x L o a d e d C o n t e n t ' ) ; 
 
 	 	 / /   s o l v e s   l i k e l y   u s e r   &   l o g g e d   i n   u s e r   m i s m a t c h   l i n k   l e n g t h   e r r o r 
 	 	 j $ ( ' # u r l ' ) . v a l ( ' # # u r l # # ' ) ; 
 	 	 
 	 	 / /   d e f i n e   f u n c t i o n   t o   u p d a t e   c h a r   c o u n t e r   i f   t w i t t e r   i s   s e l e c t e d 
 	 	 v a r   u p d a t e C h a r C o u n t   =   f u n c t i o n ( )   { 
 	 	 	 v a r   m a x   =   j $ ( ' # m a x _ c o u n t ' ) . v a l ( ) , 
 	 	 	 	 b o d y   =   j $ ( ' # m e s s a g e _ b o d y ' ) , 
 	 	 	 	 s e n d   =   j $ ( " . j S e n d M e s s a g e " ) ; 
 	 	 	 i f (   j $ ( " # t w i t t e r _ c h e c k b o x " ) . i s ( ' : c h e c k e d ' )   | |   j $ ( " # w e i b o _ c h e c k b o x " ) . i s ( ' : c h e c k e d ' )   )   { 
 	 	 	 	 j $ ( ' # c o u n t e r ' ) . v a l ( m a x   -   b o d y . v a l ( ) . l e n g t h ) ; 
 	 	 	 	 i f   ( b o d y . v a l ( ) . l e n g t h   >   m a x ) { 
 	 	 	 	 	 b o d y . p a r e n t ( ) . a d d C l a s s ( ' w a r n i n g ' ) ; 
 	 	 	 	 	 s e n d . a d d C l a s s ( ' d i s a b l e d ' ) ; 
 	 	 	 	 }   e l s e   { 
 	 	 	 	 	 b o d y . p a r e n t ( ) . r e m o v e C l a s s ( ' w a r n i n g ' ) ; 
 	 	 	 	 	 s e n d . r e m o v e C l a s s ( ' d i s a b l e d ' ) ; 
 	 	 	 	 } 
 	 	 	 }   e l s e   { 
 	 	 	 	 b o d y . p a r e n t ( ) . r e m o v e C l a s s ( ' w a r n i n g ' ) ; 
 	 	 	 	 s e n d . r e m o v e C l a s s ( ' d i s a b l e d ' ) ; 	 	 	 	 
 	 	 	 } 
 	 	 } ; 
 	 	 / /   b i n d   f u n c t i o n   t o   a l l   c h a n g e s   i n   m e s s a g e _ b o d y 
 	 	 j $ ( ' . j M e s s a g e B o d y ' ) . b i n d ( " k e y u p   k e y d o w n   k e y p r e s s   c h a n g e " ,   u p d a t e C h a r C o u n t ) ; 
 
 	 	 / /   L o o k   u p   t h e   m e s s a g e   c h a r a c t e r   l i m i t   ( t w i t t e r   o n l y )   b a s e d   o n   t h e   l i n k   l e n g t h 
 	 	 j $ . a j a x ( { 
 	 	 	 t y p e :   " P O S T " , 
 	 	 	 u r l :   T V A P P . g u i d ( " / a j a x / c h a r _ c o u n t " ) , 
 	 	 	 d a t a :   J S O N . s t r i n g i f y ( j $ ( " # r e f e r r a l - f o r m " ) . s e r i a l i z e O b j e c t ( ) ) , 
 	 	 	 c o n t e n t T y p e :   " a p p l i c a t i o n / j s o n ;   c h a r s e t = u t f - 8 " , 
 	 	 	 d a t a T y p e :   " j s o n " , 
 	 	 	 s u c c e s s :   f u n c t i o n ( d a t a )   { 
 	 	 	 	 / /   d e f i n e   t w i t t e r   m a x   l e n g t h 
 	 	 	 	 j $ ( " # m a x _ c o u n t " ) . v a l ( d a t a . R e s u l t . r e m a i n i n g _ c h a r _ c o u n t ) ; 
 	 	 	 	 / /   u p d a t e   t h e   t o o l t i p 
 	 	 	 	 v a r   t o o l t i p   =   j $ ( ' < s p a n > ' ) . h t m l ( T V A P P . s m D i c t ( ' R e f e r . M e s s a g e . T r a c k i n g L i n k . t o o l t i p ' ) ) ; 
 	 	 	 	 t o o l t i p . f i n d ( ' . j L i n k L e n g t h ' ) . t e x t ( d a t a . R e s u l t . l i n k _ l e n g t h ) ; 
 	 	 	 	 j $ ( " . s m p l _ l i n k " ) . c l i c k o v e r ( { 
 	 	 	 	 	 p l a c e m e n t : ' r i g h t ' , 
 	 	 	 	 	 t i t l e : " l i n k _ t o o l t i p " , 
 	 	 	 	 	 c o n t e n t : t o o l t i p , 
 	 	 	 	 	 h t m l :   t r u e , 
 	 	 	 	 	 a n i m a t i o n : f a l s e 
 	 	 	 	 } ) ; 
 	 	 	 	 / /   u p d a t e   t h e   c h a r a c t e r   c o u n t 
 	 	 	 	 u p d a t e C h a r C o u n t ( ) ; 
 	 	 	 } , 
 	 	 	 e r r o r :   f u n c t i o n ( x h r ,   t e x t S t a t u s ,   e r r o r )   {   T V A P P . m a s t e r E r r o r H a n d l e r ( x h r ,   t e x t S t a t u s ,   e r r o r ,   n u l l ) ;   } 
 	 	 } ) ; 
 
 	 	 / /   B i n d   s o c i a l   c h a n n e l   b u t t o n s 
 	 	 r e f r e s h S t a t u s B i n d i n g s ( ) ; 
 
 	 	 / /   B i n d   M e s s a g e   F u n c t i o n a l i t y 
 	 	 j $ ( ' . m e s s a g e _ b o d y ' ,   m o d a l ) . c l i c k ( f u n c t i o n ( ) { 
 	 	 	 j $ ( ' . j M e s s a g e B o d y ' ,   m o d a l ) . f o c u s ( ) ; 
 	 	 } ) ; 
 	 	 j $ ( " . j M e s s a g e B o d y " ) . a u t o s i z e ( ) ; 
 
 
 
 	 	 / /   B i n d   f o r m   s u b m i t   f u n c t i o n a l i t y 
 	 	 j $ ( " . j S e n d M e s s a g e " ) . b i n d ( " c l i c k " ,   f u n c t i o n ( e v e n t ) { 
 	 	 	 i f ( ! j $ ( t h i s ) . h a s C l a s s ( " d i s a b l e d " ) )   h a n d l e S t a t u s U p d a t e S u b m i t ( j $ ( " # r e f e r r a l - f o r m " ) ) ; 
 	 	 } ) ; 
 	 } ; 
 	 v a r   r e f r e s h S t a t u s B i n d i n g s   =   f u n c t i o n ( e ,   d a t a )   { 
 	 	 v a r   m o d a l   =   j $ ( ' # c b o x L o a d e d C o n t e n t ' ) ; 
 	 	 / /   i f   s o c i a l   s t a t u s   o p t i o n s   i s   n o t   o p e n ,   d o   n o t   l o a d   t h e s e   b i n d i n g s 
 	 	 i f ( ! j $ ( ' # s o c i a l _ s t a t u s _ o p t i o n s ' ) . l e n g t h )   r e t u r n   f a l s e ; 
 	 	 / /   B i n d   s o c i a l   c h a n n e l   b u t t o n s 
 	 	 i f ( j $ ( " # s o c i a l _ s t a t u s _ o p t i o n s   a " ,   m o d a l ) . l e n g t h )   { 
 	 	 	 j $ ( " # s o c i a l _ s t a t u s _ o p t i o n s   a " ,   m o d a l ) 
 	 	 	 	 . c l i c k ( f u n c t i o n ( e v e n t ) { 
 	 	 	 	 	 e v e n t . p r e v e n t D e f a u l t ( ) ; 
 	 	 	 	 	 T V A P P . l o g i n [ j $ ( t h i s ) . a t t r ( ' d a t a - c h a n n e l ' ) ] ( { c l i c k _ e v e n t :   e v e n t } ) ;   
 	 	 	 	 } ) 
 	 	 	 	 . e a c h ( f u n c t i o n ( ) { 
 	 	 	 	 	 i f   ( j $ ( t h i s ) . h a s C l a s s ( " c u s t o m _ t o o l t i p " ) )   { 
 	 	 	 	 	 	 j $ ( t h i s ) . t o o l t i p ( { 
 	 	 	 	 	 	 	 p l a c e m e n t : ' l e f t ' ,   
 	 	 	 	 	 	 	 t i t l e :   T V A P P . s m D i c t ( ' S o c i a l N e t w o r k . T o o l t i p T e x t . ' + j $ ( t h i s ) . a t t r ( ' d a t a - c h a n n e l ' ) ) 
 	 	 	 	 	 	 } ) ; 
 	 	 	 	 	 } 
 	 	 	 	 } ) ; 
 	 	 } 
 
 	 	 / /   d e f i n e   f u n c t i o n   t o   u p d a t e   c h a r   c o u n t e r   d i s p l a y   i f   n e c e s s a r y   ( &   r u n   i t ) 
 	 	 v a r   u p d a t e C h a r D i s p l a y   =   f u n c t i o n ( )   { 
 	 	 	 / /   t e m p o r a r i l y   d i s a b l e   t h e   t o g g l e   w h i l e   a n i m a t i n g 
 	 	 	 j $ ( " # t w i t t e r _ c h e c k b o x   ,   # w e i b o _ c h e c k b o x " ) . a t t r ( " d i s a b l e d " ,   t r u e ) ; 
 	 	 	 / /   m a k e   s u r e   c h e c k b o x   s t a t e   m a t c h e s   c h a r _ c o u n t e r   s t a t e 
 	 	 	 i f (   ( j $ ( " # t w i t t e r _ c h e c k b o x " ) . i s ( ' : c h e c k e d ' )   | |   j $ ( " # w e i b o _ c h e c k b o x " ) . i s ( ' : c h e c k e d ' ) )   & &   j $ ( " # c h a r _ c o u n t e r " ) . i s ( ' : h i d d e n ' ) ) { 
 	 	 	 	 j $ . c o l o r b o x . r e s i z e ( { 
 	 	 	 	 	 i n n e r H e i g h t :   j $ ( ' # c b o x L o a d e d C o n t e n t ' ) . h e i g h t ( ) + j $ ( ' # c h a r _ c o u n t e r ' ) . h e i g h t ( ) 
 	 	 	 	 } ) ; 
 	 	 	 	 j $ ( " # c h a r _ c o u n t e r " ) . s t o p ( t r u e , t r u e ) . s h o w ( 3 5 0 ,   f u n c t i o n ( )   {   j $ ( " # t w i t t e r _ c h e c k b o x   ,   # w e i b o _ c h e c k b o x " ) . r e m o v e A t t r ( " d i s a b l e d " ) ;   } ) ; 
 	 	 	 }   e l s e   i f   ( ! j $ ( " # t w i t t e r _ c h e c k b o x   ,   # w e i b o _ c h e c k b o x " ) . i s ( ' : c h e c k e d ' )   & &   j $ ( " # c h a r _ c o u n t e r " ) . i s ( ' : v i s i b l e ' ) )   { 
 	 	 	 	 j $ . c o l o r b o x . r e s i z e ( { 
 	 	 	 	 	 i n n e r H e i g h t :   j $ ( ' # c b o x L o a d e d C o n t e n t ' ) . h e i g h t ( ) - j $ ( ' # c h a r _ c o u n t e r ' ) . h e i g h t ( ) 
 	 	 	 	 } ) ; 
 	       	 	   	 j $ ( " # c h a r _ c o u n t e r " ) . s t o p ( t r u e , t r u e ) . h i d e ( 3 5 0 ,   f u n c t i o n ( )   {   j $ ( " # t w i t t e r _ c h e c k b o x   ,   # w e i b o _ c h e c k b o x " ) . r e m o v e A t t r ( " d i s a b l e d " ) ;   } ) ; 
 	 	 	 }   e l s e   { 
 	 	 	 	 j $ . c o l o r b o x . r e s i z e ( ) ; 
 	 	 	 	 j $ ( " # t w i t t e r _ c h e c k b o x   ,   # w e i b o _ c h e c k b o x " ) . r e m o v e A t t r ( " d i s a b l e d " ) ; 
 	 	 	 } 
 	 	 	 j $ ( " . j M e s s a g e B o d y " ) . t r i g g e r ( ' c h a n g e ' ) ; 
 	 	 } ; 
 	 	 u p d a t e C h a r D i s p l a y ( ) ; 
 	 
 	 	 / /   A d d   t w i t t e r   c h e c k b o x   t o g g l e   f o r   c h a r a c t e r   c o u n t 
 	 	 j $ ( " # t w i t t e r _ c h e c k b o x   ,   # w e i b o _ c h e c k b o x " ) . c h a n g e ( u p d a t e C h a r D i s p l a y ) ; 
 
 	 } ; 
 	 
 	 v a r   h a n d l e S t a t u s U p d a t e S u b m i t   =   f u n c t i o n ( t h e F o r m )   { 
 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k E v e n t " ,   {   a c t i o n :   " S e n d   M e s s a g e " ,   l a b e l :   ' j R e f e r A l l C o n t a c t s '   } ) ; 
 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k P a g e " ,   {   u r l :   " / g a / a j a x / r e f e r / S e n d M e s s a g e " } ) ; 
 
 	 	 / /   F o r m a t   B r o a d c a s t   C h a n n e l s   c o r r e c t l y 
 	 	 v a r   b r o a d c a s t C h a n n e l s   =   n e w   A r r a y ( ) ; 
 	 	 j $ ( ' [ n a m e = " M e s s a g e . s o c i a l _ c h a n n e l s " ] : c h e c k e d ' ,   t h e F o r m ) . e a c h ( f u n c t i o n ( )   { 
 	 	 	 b r o a d c a s t C h a n n e l s . p u s h ( j $ ( t h i s ) . v a l ( ) ) ; 
 	 	 } ) ; 
 	 	 j $ ( " i n p u t [ n a m e = ' M e s s a g e . b r o a d c a s t _ c h a n n e l s ' ] " ) . v a l (   J S O N . s t r i n g i f y ( b r o a d c a s t C h a n n e l s )   ) ; 
 
 	 	 / /   A d d   l o a d i n g   a n i m a t i o n 
 	 	 T V A P P . m o d a l . l o a d i n g S t a r t ( ) ; 
 	 	 
 	 	 / /   P o s t   m e s s a g e   f o r m 
 	 	 j $ . a j a x ( { 
 	 	 	 t y p e :   ' P O S T ' , 
 	 	 	 c o n t e n t T y p e :   " a p p l i c a t i o n / j s o n ;   c h a r s e t = u t f - 8 " , 
 	 	 	 u r l :   T V A P P . g u i d ( t h e F o r m . a t t r ( ' a c t i o n ' ) ) , 
 	 	 	 d a t a :   J S O N . s t r i n g i f y ( t h e F o r m . s e r i a l i z e O b j e c t ( ) ) , 
 	 	 	 c o n t e n t T y p e :   " a p p l i c a t i o n / j s o n ;   c h a r s e t = u t f - 8 " , 
 	 	 	 d a t a T y p e :   ' j s o n ' , 
 	 	 	 s u c c e s s :   f u n c t i o n ( r e s u l t )   {   
 	 	 	 	 i f ( r e s u l t . S t a t u s   = =   " O K " )   { 
 	 	 	 	 	 v a r   u s e r M e s s a g e   =   r e s u l t . U s e r M e s s a g e ; 
 	 	 	 	 	 j $ ( " b o d y " ) . m o d a l ( { 
 	 	 	 	 	 	 " t e x t " : u s e r M e s s a g e , 
 	 	 	 	 	 	 " o n C l o s e " :   f u n c t i o n ( )   {   T V A P P . m o d a l . c l o s e ( ) ;   } 
 	 	 	 	 	 } ) ; 
 	 	 	 	 }   e l s e   { 
 	 	 	 	 	 j $ . l o g ( r e s u l t . E r r o r s . G E N E R I C _ E R R O R _ S T R I N G ) ; 
 	 	 	 	 } 
 	 	 	 } , 
 	 	 	 e r r o r :   f u n c t i o n ( x h r ,   t e x t S t a t u s ,   e r r o r )   {   T V A P P . m a s t e r E r r o r H a n d l e r ( x h r ,   t e x t S t a t u s ,   e r r o r ,   n u l l ) ;   } , 
 	 	 	 c o m p l e t e :   f u n c t i o n ( )   {   
 	 	 	 	 T V A P P . m o d a l . l o a d i n g S t o p ( ) ; 
 	 	 	 } 
 	 	 } ) ; 
 	 } ; 
 
 	 j $ ( d o c u m e n t ) . b i n d ( ' s t a t u s U p d a t e ' ,   h a n d l e S t a t u s U p d a t e ) ; 
 	 j $ ( d o c u m e n t ) . b i n d ( ' s t a t u s _ u p d a t e _ m o d a l _ i n i t ' ,   h a n d l e S t a t u s U p d a t e M o d a l I n i t i a l i z e ) ; 
 	 j $ ( d o c u m e n t ) . b i n d ( " r e f r e s h U s e r B i n d i n g s " , r e f r e s h S t a t u s B i n d i n g s ) ; 
 	 
 	 v a r   h a n d l e L i n k e d i n M e s s a g e   =   f u n c t i o n ( e ,   d a t a )   { 
 	 	 d a t a   =   d a t a   | |   { } ; 
 	 	 j $ . e x t e n d ( d a t a ,   {   m o d e : " l i n k e d i n M e s s a g e " ,   a v a i l a b l e _ c h a n n e l s : T V A P P . u s e r . g e t A u t h e n t i c a t e d C h a n n e l s ( )   } ) ; 
 	 	 / /   i f   n o t   r e g i s t e r e d   o p e n   r e g i s t r a t i o n   m o d a l   &   s e t   n e x t 
 	 	 i f   ( T V A P P . u s e r . g e t R e g S t a t u s ( )   = =   " u n r e g i s t e r e d " )   { 
 	 	 	 / /   s e t   n e x t   a c t i o n   a n d   r e d i r e c t   t o   r e g i s t e r 
 	 	 	 j $ . l o g ( ' - >   R e d i r e c t   t o   r e g i s t e r ' ) ; 
 	 	 	 T V A P P . m o d a l . p r o c e e d   =   f a l s e ; 
 	 	 	 T V A P P . m o d a l . n e x t A c t i o n   =   f u n c t i o n ( )   {   j $ ( d o c u m e n t ) . t r i g g e r ( ' l i n k e d i n M e s s a g e ' , d a t a ) ;   } ; 
 	 	 	 j $ ( d o c u m e n t ) . b i n d ( " u s e r I n f o U p d a t e d . m o d a l . l i n k e d i n " ,   f u n c t i o n ( )   { 
 	 	 	 	 i f ( T V A P P . u s e r . g e t R e g S t a t u s ( )   ! =   " u n r e g i s t e r e d " )   { 
 	 	 	 	 	 j $ . l o g ( ' < -   R e a t t e m p t   l i n k e d i n   m e s s a g e ' ) ; 
 	 	 	 	 	 T V A P P . m o d a l . p r o c e e d   =   t r u e ; 
 	 	 	 	 	 T V A P P . m o d a l . c l o s e ( ) ; 
 	 	 	 	 	 j $ ( d o c u m e n t ) . u n b i n d ( ' . l i n k e d i n ' ) ; 
 	 	 	 	 } 
 	 	 	 } ) ; 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' r e g i s t e r M o d a l ' ,   d a t a ) ; 
 	 	 / /   i f   l i n k e d i n   n o t   t e t h e r e d   o p e n   A u t h   d i a l o g   I M M E D I A T E   O N L Y 
 	 	 }   e l s e   i f   ( j $ . i n A r r a y ( ' l i n k e d i n ' , d a t a . a v a i l a b l e _ c h a n n e l s )   = =   - 1   & &   T V A P P . m o d a l . s t a t e   = =   ' c l o s e d ' )   { 
 	 	 	 / /   s e t   n e x t   a c t i o n   a n d   o p e n   L i n k e d I n   a u t h e n t i c a t i o n 
 	 	 	 j $ . l o g ( ' - >   R e d i r e c t   t o   l i n k e d i n   a u t h ' ) ; 
 	 	 	 T V A P P . m o d a l . p r o c e e d   =   f a l s e ; 
 	 	 	 T V A P P . m o d a l . n e x t A c t i o n   =   f u n c t i o n ( )   {   j $ ( d o c u m e n t ) . t r i g g e r ( ' l i n k e d i n M e s s a g e ' , d a t a ) ;   } ; 
 	 	 	 j $ ( d o c u m e n t ) . b i n d ( " u s e r I n f o U p d a t e d . m o d a l . l i n k e d i n " ,   f u n c t i o n ( )   { 
 	 	 	 	 j $ . l o g ( ' < -   R e a t t e m p t   l i n k e d i n   m e s s a g e ' ) ; 
 	 	 	 	 T V A P P . m o d a l . p r o c e e d   =   t r u e ; 
 	 	 	 	 T V A P P . m o d a l . c l o s e ( ) ; 
 	 	 	 	 j $ ( d o c u m e n t ) . u n b i n d ( ' . l i n k e d i n ' ) ; 
 	 	 	 } ) ; 
 	 	 	 T V A P P . l o g i n . l i n k e d i n ( j $ . e x t e n d ( d a t a ,   { m e t h o d : " d e f a u l t " } ) ) ; 
 	 	 / /   i f   l i n k e d i n   n o t   t e t h e r e d   a n d   m o d a l   a l r e a d y   o p e n   w e   m u s t   i n i t i a t e   a   n e w   c l i c k   e v e n t   t o   a v o i d   p o p - u p   b l o c k e r s 
 	 	 }   e l s e   i f   ( j $ . i n A r r a y ( ' l i n k e d i n ' , d a t a . a v a i l a b l e _ c h a n n e l s )   = =   - 1 )   { 
 	 	 	 j $ ( " b o d y " ) . m o d a l ( { 
 	 	 	 	 " t e x t " :   T V A P P . s m D i c t ( " R e f e r . M o d a l . L i n k e d I n . a u t h _ m e s s a g e " ) , 
 	 	 	 	 " o n C l o s e " :   f u n c t i o n ( )   { 
 	 	 	 	 	 / /   s e t   n e x t   a c t i o n   a n d   o p e n   L i n k e d I n   a u t h e n t i c a t i o n 
 	 	 	 	 	 j $ . l o g ( ' - >   R e d i r e c t   t o   l i n k e d i n   a u t h ' ) ; 
 	 	 	 	 	 T V A P P . m o d a l . p r o c e e d   =   f a l s e ; 
 	 	 	 	 	 T V A P P . m o d a l . n e x t A c t i o n   =   f u n c t i o n ( )   {   j $ ( d o c u m e n t ) . t r i g g e r ( ' l i n k e d i n M e s s a g e ' , d a t a ) ;   } ; 
 	 	 	 	 	 j $ ( d o c u m e n t ) . b i n d ( " u s e r I n f o U p d a t e d . m o d a l . l i n k e d i n " ,   f u n c t i o n ( )   { 
 	 	 	 	 	 	 j $ . l o g ( ' < -   R e a t t e m p t   l i n k e d i n   m e s s a g e ' ) ; 
 	 	 	 	 	 	 T V A P P . m o d a l . p r o c e e d   =   t r u e ; 
 	 	 	 	 	 	 T V A P P . m o d a l . c l o s e ( ) ; 
 	 	 	 	 	 	 j $ ( d o c u m e n t ) . u n b i n d ( ' . l i n k e d i n ' ) ; 
 	 	 	 	 	 } ) ; 
 	 	 	 	 	 / /   r e g i s t r a t i o n   f o r m   i s   s t i l l   v i s i b l e   ( e v e n   t h o u g h   c o m p l e t e ) ,   
 	 	 	 	 	 / /   m a k e   s u r e   t h a t   i t   i s   c l o s e d   u n d e r   d i f f e r e n t   e n d   f l o w   s c e n a r i o s 
 	 	 	 	 	 j $ ( d o c u m e n t ) . b i n d ( ' c h a n n e l A u t h C a n c e l l e d . m o d a l . l i n k e d i n ' ,   f u n c t i o n ( d a t a )   { 
 	 	 	 	 	 	 j $ . l o g ( ' < -   A u t h   C a n c e l l e d ,   C l o s e   M o d a l ' ) ; 
 	 	 	 	 	 	 T V A P P . m o d a l . c l o s e ( ) ; 
 	 	 	 	 	 	 j $ ( d o c u m e n t ) . u n b i n d ( ' . l i n k e d i n ' ) ; 
 	 	 	 	 	 } ) ; 
 	 	 	 	 	 j $ ( d o c u m e n t ) . b i n d ( ' c h a n n e l A u t h C o n f l i c t . m o d a l . l i n k e d i n ' ,   f u n c t i o n ( d a t a )   { 
 	 	 	 	 	 	 j $ . l o g ( ' < -   A u t h   C o n f l i c t ,   C l o s e   M o d a l ' ) ; 
 	 	 	 	 	 	 T V A P P . m o d a l . c l o s e ( ) ; 
 	 	 	 	 	 	 j $ ( d o c u m e n t ) . u n b i n d ( ' . l i n k e d i n ' ) ; 
 	 	 	 	 	 } ) ; 
 	 	 	 	 	 
 	 	 	 	 	 T V A P P . l o g i n . l i n k e d i n ( j $ . e x t e n d ( d a t a ,   { m e t h o d : " d e f a u l t " } ) ) ; 
 	 	 	 	 } 
 	 	 	 } ) ; 
 	 	 / /   f i n a l l y   o p e n   l i n k e d i n   m e s s a g e   m o d a l 
 	 	 }   e l s e   { 
 	 	 	 T V A P P . m o d a l . o p e n ( ' l i n k e d i n _ m e s s a g e _ m o d a l ' ,   { } ,   d a t a ) ; 
 	 	 } 
 	 } ; 
 	 
 	 v a r   h a n d l e L i n k e d i n M e s s a g e M o d a l I n i t i a l i z e   =   f u n c t i o n ( e ,   d a t a )   { 
 	 	 
 	 	 / /   t r a c k i n g 
 	 	 i f ( ! T V A P P . i s E m p t y ( d a t a . s u g g e s t i o n ) )   { 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k E v e n t " ,   {   a c t i o n :   " S e n d   M e s s a g e   F r o m   S u g g e s t e d   P r o m o " ,   l a b e l :   ' j S u g C o n R o w '   } ) ; 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k P a g e " ,   {   u r l :   " / g a / a j a x / r e f e r / S e n d M e s s a g e F r o m S u g g e s t e d P r o m o " } ) ; 
 	 	 }   e l s e   { 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k E v e n t " ,   {   a c t i o n :   " S e n d   M e s s a g e " ,   l a b e l :   ' j R e f e r S o m e C o n t a c t s '   } ) ; 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k P a g e " ,   {   u r l :   " / g a / a j a x / r e f e r / S e n d M e s s a g e " } ) ; 
 	 	 } 
 
 	 	 / /   v a r s 
 	 	 v a r   m o d a l   =   j $ ( ' # c b o x L o a d e d C o n t e n t ' ) ; 
 	 	 v a r   c o n t a c t s   =   n e w   A r r a y ( ) ; 
 	 	 v a r   c o n t a c t s L i s t ;   / /   a p i   f o r   j s p S c r o l l e r 
 
 	 	 / /   B i n d   f o r m   s u b m i t   f u n c t i o n a l i t y 
 	 	 j $ ( " . j S e n d M e s s a g e " ,   m o d a l ) . b i n d ( " c l i c k " ,   f u n c t i o n ( e v e n t ) { 
 	 	 	 h a n d l e L i n k e d I n M e s s a g e S u b m i t ( j $ ( " # r e f e r r a l - f o r m " ) ,   c o n t a c t s ) ; 
 	 	 } ) ; 
 	 	 
 	 	 / /   B i n d   M e s s a g e   F u n c t i o n a l i t y 
 	 	 j $ ( ' . m e s s a g e _ b o d y ' ,   m o d a l ) . c l i c k ( f u n c t i o n ( ) { 
 	 	 	 j $ ( ' . j M e s s a g e B o d y ' ,   m o d a l ) . f o c u s ( ) ; 
 	 	 } ) ; 
 	 	 
 	 	 / /   I n i t i a l i z e   j S c r o l l P a n e 
 	 	 v a r   p a n e   =   j $ ( ' . j S u g g e s t e d H o l d e r ' ) ; 
 	 	 p a n e . j S c r o l l P a n e ( { 
 	 	 	 s h o w A r r o w s :   f a l s e , 
 	 	 	 a n i m a t e S c r o l l :   t r u e , 
 	 	 	 t r a c k C l i c k S p e e d :   1 , 
 	 	 	 c l i c k O n T r a c k :   t r u e , 
 	 	 	 a n i m a t e E a s e :   ' s w i n g ' , 
 	 	 	 a n i m a t e D u r a t i o n :   2 0 0 , 
 	 	 	 h i d e F o c u s :   t r u e , 
 	 	 	 v e r t i c a l G u t t e r :   0 , 
 	 	 	 v e r t i c a l D r a g M i n H e i g h t :   2 0 
 	 	 } ) . b i n d ( ' j s p - s c r o l l - y ' ,   f u n c t i o n ( )   { 
 	 	 	 j $ ( ' . j C o n t a c t S e a r c h ' ,   m o d a l ) . p o p o v e r ( ' d e s t r o y ' ) ; 
 	 	 	 j $ ( ' . j C o n t a c t A d d . a c t i v e ' ,   m o d a l ) . r e m o v e C l a s s ( ' a c t i v e ' ) ; 
 	 	 	 i f ( j $ ( " . j L o a d M o r e " ) . l e n g t h   & &   r e a d y F o r M o r e )   { 
 	 	 	 	 i f ( i s S c r o l l e d I n t o V i e w ( j $ ( " . j L o a d M o r e " ) ) )   { 
 	 	 	 	 	 r e a d y F o r M o r e   =   f a l s e ; 
 	 	 	 	 	 l o a d M o r e C o n t a c t s ( ) ; 
 	 	 	 	 } 
 	 	 	 } 
 	 	 } ) ; 
 	 	 c o n t a c t s L i s t   =   p a n e . d a t a ( ' j s p ' ) ; 
 
 	 	 j $ ( d o c u m e n t ) . b i n d ( ' c o n t a c t L i s t U p d a t e d ' ,   f u n c t i o n ( )   { 
 	 	 	 / /   u p d a t e   t h e   j S c r o l l P a n e 
 	 	 	 c o n t a c t s L i s t . r e i n i t i a l i s e ( ) ; 
 	 	 	 / /   A d d   s l i d e   t o   s n a p   o n   d r a g 
 	 	 	 j $ ( ' . j s p D r a g ' ) . m o u s e d o w n ( f u n c t i o n ( e )   { 
 	 	 	 	 j $ ( d o c u m e n t ) . o n e ( ' m o u s e u p . j s p S n a p ' ,   f u n c t i o n ( )   { 
 	 	 	 	 	 s l i d e T o S n a p ( ) ; 
 	 	 	 	 	 j $ ( d o c u m e n t ) . u n b i n d ( ' . j s p S n a p ' ) ; 
 	 	 	 	 } ) ; 
 	 	 	 	 r e t u r n   f a l s e ; 
 	 	 	 } ) ; 
 	 	 } ) ; 
 	 	 / /   b i n d   m o u s e w h e e l   s l i d e   t o   s n a p 
 	 	 v a r   s n a p T i m e r ; 
 	 	 j $ ( ' . j s p C o n t a i n e r ' ) . b i n d ( ' m o u s e w h e e l ' ,   f u n c t i o n ( e v e n t )   { 
 	 	 	 c l e a r T i m e o u t ( s n a p T i m e r ) ; 
 	 	 	 s n a p T i m e r   =   s e t T i m e o u t ( f u n c t i o n ( ) { 
 	 	 	 	 s l i d e T o S n a p ( ) ; 
 	 	 	 } ,   3 0 0 ) ; 
 	 	 } ) ; 
 	 	 
 	 	 / /   D e f i n e   S l i d e   t o   S n a p   a c t i o n 
 	 	 f u n c t i o n   s l i d e T o S n a p ( )   { 
 	 	 	 v a r   p r e v P o s   =   0 ,   c u r r P o s   =   c o n t a c t s L i s t . g e t C o n t e n t P o s i t i o n Y ( ) ,   d e s t ; 
 	 	 	 c o n t a c t s L i s t . g e t C o n t e n t P a n e ( ) . f i n d ( ' . s n a p : v i s i b l e ' ) . e a c h ( f u n c t i o n ( i n d e x ,   e l e m )   { 
 	 	 	 	 i f ( j $ ( e l e m ) . p o s i t i o n ( ) . t o p   >   c u r r P o s )   { 
 	 	 	 	 	 d e s t   =   ( c u r r P o s - p r e v P o s   > =   j $ ( e l e m ) . p o s i t i o n ( ) . t o p - c u r r P o s ) ?   j $ ( e l e m ) . p o s i t i o n ( ) . t o p   :   p r e v P o s ; 
 	 	 	 	 	 c o n t a c t s L i s t . s c r o l l T o Y ( p a r s e I n t ( d e s t ) ) ; 
 	 	 	 	 	 r e t u r n   f a l s e ; 
 	 	 	 	 } 
 	 	 	 	 e l s e   { 
 	 	 	 	 	 p r e v P o s   =   j $ ( e l e m ) . p o s i t i o n ( ) . t o p ; 
 	 	 	 	 } 
 	 	 	 } ) ; 
 	 	 } 
 	 	 
 	 	 / /   B i n d   a   c l i c k   w i t h i n   t h e   " T o : "   f i e l d   t o   f o c u s   o n   t h e   c o n t a c t   s e a r c h   f i e l d 
 	 	 j $ ( ' # m e s s a g e - r e c i p i e n t s ' ) . c l i c k ( f u n c t i o n ( e v e n t ) { 
 	 	 	 j $ ( ' . j S e a r c h C o n t a c t s ' ) . f o c u s ( ) ; 
 	 	 } ) ; 
 	 	 
 	 	 / /   S e t   t h e   m e s s a g e   c h a r a c t e r   c o u n t s   b a s e d   o n   t h e   l i n k   l e n g t h 
 	 	 j $ ( ' # u r l ' ) . v a l ( w i n d o w . l o c a t i o n . p r o t o c o l + ' / / ' + w i n d o w . l o c a t i o n . h o s t n a m e + w i n d o w . l o c a t i o n . p a t h n a m e ) ; 
 	 	 j $ . a j a x ( { 
 	 	 	 t y p e :   " P O S T " , 
 	 	 	 u r l :   T V A P P . g u i d ( " / a j a x / c h a r _ c o u n t " ) , 
 	 	 	 d a t a :   J S O N . s t r i n g i f y ( j $ ( " # r e f e r r a l - f o r m " ) . s e r i a l i z e O b j e c t ( ) ) , 
 	 	 	 c o n t e n t T y p e :   " a p p l i c a t i o n / j s o n ;   c h a r s e t = u t f - 8 " , 
 	 	 	 d a t a T y p e :   " j s o n " , 
 	 	 	 s u c c e s s :   f u n c t i o n ( d a t a )   { 
 	 	 	 	 j $ ( " # m a x _ c o u n t " ) . v a l ( d a t a . R e s u l t . r e m a i n i n g _ c h a r _ c o u n t ) ; 
 	 	 	 	 j $ ( " # l i n k _ l e n g t h " ) . v a l ( d a t a . R e s u l t . l i n k _ l e n g t h ) ; 
 	 	 	 	 v a r   t o o l t i p   =   j $ ( ' < s p a n > ' ) . h t m l ( T V A P P . s m D i c t ( ' R e f e r . M e s s a g e . T r a c k i n g L i n k . t o o l t i p ' ) ) ; 
 	 	 	 	 t o o l t i p . f i n d ( ' . j L i n k L e n g t h ' ) . t e x t ( d a t a . R e s u l t . l i n k _ l e n g t h ) ; 
 	 	 	 	 j $ ( " . s m p l _ l i n k " ) . c l i c k o v e r ( { 
 	 	 	 	 	 p l a c e m e n t : ' r i g h t ' , 
 	 	 	 	 	 t i t l e : " l i n k _ t o o l t i p " , 
 	 	 	 	 	 c o n t e n t : t o o l t i p , 
 	 	 	 	 	 h t m l :   t r u e , 
 	 	 	 	 	 a n i m a t i o n : f a l s e , 
 	 	 	 	 	 o n S h o w n :   f u n c t i o n ( )   { 
 	 	 	 	 	 	 j $ ( ' . j L i n k L e n g t h ' ,   ' . l i n k _ t o o l t i p ' ) . t e x t ( d a t a . R e s u l t . l i n k _ l e n g t h ) ; 
 	 	 	 	 	 } 
 	 	 	 	 } ) ; 
 	 	 	 } , 
 	 	 	 e r r o r :   f u n c t i o n ( x h r ,   t e x t S t a t u s ,   e r r o r )   {   T V A P P . m a s t e r E r r o r H a n d l e r ( x h r ,   t e x t S t a t u s ,   e r r o r ,   n u l l ) ;   } 
 	 	 } ) ; 
 
 	 	 / /   a d d   s e a r c h   c o n t a c t s   f u n c t i o n a l i t y 
 	 	 j $ ( " . j C o n t a c t S e a r c h S u b m i t " ,   m o d a l ) . b i n d ( " c l i c k " , f u n c t i o n ( e v e n t ) { 
 	 	 	 j $ ( ' . j S e a r c h C o n t a c t s ' ,   m o d a l ) . r e f e r c o m p l e t e ( " c l o s e " ) ; 
 	 	 	 j $ ( ' . j C o n t a c t S e a r c h ' ,   m o d a l ) . p o p o v e r ( ' d e s t r o y ' ) ; 
 	 	 	 / /   r e m o v e   a n y   p r e v i o u s   s e a r c h   r e s u l t s 
 	 	 	 c o n t a c t s L i s t . g e t C o n t e n t P a n e ( ) . f i n d ( ' . j S u g g e s t W r a p ' ) . n e x t A l l ( ) . r e m o v e ( ) ; 
 	 	 	 / /   a d d   s p i n n e r 
 	 	 	 c o n t a c t s L i s t . g e t C o n t e n t P a n e ( ) . a p p e n d ( " < d i v   i d = ' c o n t a c t _ s p i n n e r '   / > " ) ; 
 	 	 	 j $ ( ' # c o n t a c t _ s p i n n e r ' ) . s p i n ( { 
 	 	 	 	 l i n e s :   1 3 ,   / /   T h e   n u m b e r   o f   l i n e s   t o   d r a w 
 	 	 	 	 l e n g t h :   6 ,   / /   T h e   l e n g t h   o f   e a c h   l i n e 
 	 	 	 	 w i d t h :   2 ,   / /   T h e   l i n e   t h i c k n e s s 
 	 	 	 	 r a d i u s :   5 ,   / /   T h e   r a d i u s   o f   t h e   i n n e r   c i r c l e 
 	 	 	 	 c o l o r :   ' # 5 5 5 '   / /   # r g b   o r   # r r g g b b 
 	 	 	 } ) ; 
 	 	 	 / /   c o l l a p s e   s u g g e s t e d   c o n t a c t s 
 	 	 	 i f ( ! j $ ( ' . j S u g g e s t T o g g l e ' ) . h a s C l a s s ( ' c o l l a p s e d ' ) )   { 
 	 	 	 	 j $ ( ' . j S u g g e s t T o g g l e ' ) . c l i c k ( ) ; 
 	 	 	 }   e l s e   { 
 	 	 	 	 c o n t a c t s L i s t . r e i n i t i a l i s e ( ) ; 	 
 	 	 	 } 
 	 	 	 v a r   p a r a m s   =   { 
 	 	 	 	 k e y w o r d s : ( j $ ( " . j S e a r c h C o n t a c t s " ) . v a l ( )   = =   j $ ( " . j S e a r c h C o n t a c t s " ) . a t t r ( " p l a c e h o l d e r " )   ?   ' '   :   j $ ( " . j S e a r c h C o n t a c t s " ) . v a l ( ) ) , 
 	 	 	 	 s o c i a l _ c h a n n e l s : ' [ " l i n k e d i n " ] ' 
 	 	 	 } ; 
 	 	 	 j $ . a j a x ( { 
 	 	 	 	 t y p e :   ' P O S T ' , 
 	 	 	 	 u r l :   T V A P P . g u i d ( ' / a j a x / s e a r c h - c o n t a c t s ' ) , 
 	 	 	 	 d a t a :   p a r a m s , 
 	 	 	 	 s u c c e s s :   f u n c t i o n ( r e s p o n s e ) { 
 	 	 	 	 	 c r e a t e U s e r S e a r c h R e s u l t s ( r e s p o n s e . R e s u l t , p a r a m s . k e y w o r d s ) ; 
 	 	 	 	 } , 
 	 	 	 	 d a t a T y p e :   ' j s o n ' , 
 	 	 	 	 e r r o r :   f u n c t i o n ( x h r ,   t e x t S t a t u s ,   e r r o r )   {   T V A P P . m a s t e r E r r o r H a n d l e r ( x h r ,   t e x t S t a t u s ,   e r r o r ,   n u l l ) ;   } , 
 	 	 	 	 c o m p l e t e :   f u n c t i o n ( )   {   } 
 	 	 	 } ) ; 
 	 	 } ) ; 
 	 	 / /   p a r s e   s e a r c h   r e s u l t s 
 	 	 v a r   c r e a t e U s e r S e a r c h R e s u l t s   =   f u n c t i o n ( r e s u l t , k e y w o r d s ) { 
 	 	 	 c o n t a c t s L i s t . g e t C o n t e n t P a n e ( ) . a p p e n d ( ' < d i v   i d = " j C o n t a c t S e a r c h T i t l e "   c l a s s = " s e c t i o n _ t i t l e   s n a p " > ' + T V A P P . s m D i c t ( ' g l o b a l . s e a r c h _ r e s u l t s ' ) + ' < / d i v > ' ) ; 
 	 	 	 c o n t a c t s L i s t . g e t C o n t e n t P a n e ( ) . a p p e n d ( r e s u l t ) ;   / /   a p p e n d   n e w   s e a r c h   r e s u l t s 
 	 	 	 / /   r e m o v e   s p i n n e r 
 	 	 	 j $ ( ' # c o n t a c t _ s p i n n e r ' ) . s l i d e U p ( 4 0 0 ,   f u n c t i o n ( )   { 
 	 	 	 	 j $ ( ' # c o n t a c t _ s p i n n e r ' ) . r e m o v e ( ) ; 
 	 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' c o n t a c t L i s t U p d a t e d ' ) ; 
 	 	 	 } ) ; 
 	 	 	 / /   u p d a t e   p a g i n a t i o n   v a r i a b l e s 
 	 	 	 j $ ( ' # j K e y w o r d s ' ) . v a l ( k e y w o r d s ) ; 
 	 	 	 j $ ( ' . j K e y w o r d s ' ,   m o d a l ) . t e x t ( k e y w o r d s ) ; 
 	 	 	 j $ ( " i n p u t [ n a m e = ' p a g e _ i n d e x ' ] " ) . v a l ( 1 ) ; 
 	 	 	 j $ ( " i n p u t [ n a m e = ' n u m _ p a g e s ' ] " ) . v a l ( p a r s e I n t ( j $ ( " i n p u t [ n a m e = ' n u m _ p a g e s _ i n i t ' ] " ) . v a l ( ) ) ) ;   / / s e t   i n i t i a l   n u m b e r   o f   p a g e s 
 	 	 	 j $ ( ' # j C o n t a c t S e a r c h T i t l e ' ) . p r e p e n d ( ' < s p a n   c l a s s = " n u m _ r e s u l t s " > ( ' + p a r s e I n t ( j $ ( " i n p u t [ n a m e = ' n u m _ r e s u l t s _ i n i t ' ] " ) . v a l ( ) ) + ' ) < / s p a n > ' ) ; 
 	 	 	 / /   a d d   p a g i n a t i o n   l o a d i n g   d i v   i f   n e e d e d 
 	 	 	 i f (   p a r s e I n t ( j $ ( " i n p u t [ n a m e = ' n u m _ p a g e s ' ] " ) . v a l ( ) )   >   1   )   { 
 	 	 	 	 c o n t a c t s L i s t . g e t C o n t e n t P a n e ( ) . a p p e n d ( " < d i v   c l a s s = ' j L o a d M o r e ' > < / d i v > " ) ; 
 	 	 	 	 j $ ( ' . j L o a d M o r e ' ) . s p i n ( ) ; 
 	 	 	 } 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' c o n t a c t L i s t U p d a t e d ' ) ;   / /   l i n k e d i n   c o n t a c t s   s e a r c h   i e   f i x 
 	 	 } ; 
 
 	 	 v a r   r e s e t P o p o v e r   =   f u n c t i o n ( ) { 
 	 	 	 j $ ( ' . j C o n t a c t S e a r c h ' ,   m o d a l ) . p o p o v e r ( ' d e s t r o y ' ) ; 
 	 	 	 j $ ( ' . j C o n t a c t A d d . a c t i v e ' ) . r e m o v e C l a s s ( ' a c t i v e ' ) ; 
 	 	 	 j $ ( ' b o d y ' ) . u n b i n d ( ' . p o p o v e r ' ) ; 	 	 	 
 	 	 } ; 
 
 	 	 j $ ( d o c u m e n t ) . b i n d ( ' c o n t a c t L i s t U p d a t e d ' ,   f u n c t i o n ( )   { 
 	 	 	 j $ ( ' . j C o n t a c t S e a r c h ' ,   m o d a l ) . p o p o v e r ( ' d e s t r o y ' ) ; 
 	 	 	 j $ ( " . j C o n t a c t A d d " ,   m o d a l ) . n o t ( ' . p r o c e s s e d ' ) . e a c h ( f u n c t i o n ( )   { 
 	 	 	 	 j $ ( t h i s ) . b i n d ( " c l i c k " , f u n c t i o n ( ) { 
 	 	 	 	 	 p u s h S u g g e s t e d C o n t a c t ( j $ ( t h i s ) . f i n d ( ' . j C o n t a c t V a l u e s ' ) . v a l ( ) ) ; 
 	 	 	 	 } ) ; 
 	 	 	 	 / / d i s p l a y   C o n t a c t   p o p O v e r   f o r   d e s k t o p   o n l y 
 	 	 	 	 i f   ( ! j $ ( " b o d y " ) . h a s C l a s s ( " m o b i l e " ) )   { 
 	 	 	 	 	 j $ ( t h i s ) . f i n d ( " . j H i d e I n f o " ) . b i n d ( " c l i c k " , f u n c t i o n ( e v e n t ) { 
 	 	 	 	 	 	 e v e n t . s t o p P r o p a g a t i o n ( ) ; 
 	 	 	 	 	 	 r e s e t P o p o v e r ( ) ; 
 	 	 	 	 	 } ) ; 
 	 	 	 	 	 j $ ( t h i s ) . f i n d ( " . j S h o w I n f o " ) . b i n d ( " c l i c k " , f u n c t i o n ( e v e n t ) { 
 	 	 	 	 	 	 e v e n t . s t o p P r o p a g a t i o n ( ) ; 
 	 	 	 	 	 	 e l e m   =   e v e n t . c u r r e n t T a r g e t ; 
 	 	 	 	 	 	 j $ ( t h i s ) . p a r e n t ( ' . j C o n t a c t A d d ' ) . a d d C l a s s ( ' a c t i v e ' ) . s i b l i n g s ( ) . r e m o v e C l a s s ( ' a c t i v e ' ) ; 
 	 	 	 	 	 	 i f ( j $ ( ' . l i n k _ t o o l t i p ' ,   m o d a l ) . l e n g t h )   j $ ( ' . s m p l _ l i n k ' ) . c l i c k o v e r ( ' f o r c e h i d e ' ) ; 
 	 	 	 	 	 	 j $ ( ' . j C o n t a c t S e a r c h ' ,   m o d a l ) . p o p o v e r ( ' d e s t r o y ' ) . p o p o v e r ( { 
 	 	 	 	 	 	 	 p l a c e m e n t : ' r i g h t ' , 
 	 	 	 	 	 	 	 t i t l e : " c o n t a c t _ d e t a i l _ p o p " , 
 	 	 	 	 	 	 	 c o n t e n t : j $ ( e l e m ) . s i b l i n g s ( " . j C o n t a c t D e t a i l " ) . h t m l ( ) , 
 	 	 	 	 	 	 	 h t m l :   t r u e , 
 	 	 	 	 	 	 	 t r i g g e r :   ' m a n u a l ' , 
 	 	 	 	 	 	 	 a n i m a t i o n : f a l s e 	 	 	 
 	 	 	 	 	 	 } ) . p o p o v e r ( ' s h o w ' ) ; 	 	 	 	 
 	 	 	 	 	 	 v a r   y p o s   =   j $ ( e l e m ) . p a r e n t ( ' . j C o n t a c t A d d ' ) . p o s i t i o n ( ) . t o p   +   1 1 3   -   c o n t a c t s L i s t . g e t C o n t e n t P o s i t i o n Y ( ) ; 
 	 	 	 	 	 	 j $ ( ' . c o n t a c t _ d e t a i l _ p o p   . a r r o w ' ) . c s s ( { t o p : y p o s } ) ; 
 	 	 	 	 	 	 j $ ( " . j D e t a i l C o n t a c t A d d " ,   m o d a l ) . u n b i n d ( ' c l i c k ' ) . b i n d ( " c l i c k " , f u n c t i o n ( ) { 
 	 	 	 	 	 	 	 p u s h S u g g e s t e d C o n t a c t ( j $ ( " . j C o n t a c t A d d . a c t i v e " ) . f i r s t ( ) . f i n d ( ' . j C o n t a c t V a l u e s ' ) . v a l ( ) ) ; 
 	 	 	 	 	 	 	 j $ ( " . j C o n t a c t A d d . a c t i v e   . j H i d e I n f o " ) . c l i c k ( ) ; 
 	 	 	 	 	 	 } ) ; 
 	 	 	 	 	 	 j $ ( ' . j C l o s e P o p o v e r ' ,   m o d a l ) . b i n d ( " c l i c k " , f u n c t i o n ( ) { 
 	 	 	 	 	 	 	 e v e n t . s t o p P r o p a g a t i o n ( ) ; 
 	 	 	 	 	 	 	 r e s e t P o p o v e r ( ) ; 
 	 	 	 	 	 	 } ) ; 
 	 	 	 	 	 	 j $ ( ' b o d y ' ) . b i n d ( ' c l i c k . p o p o v e r ' ,   f u n c t i o n ( e )   { 
 	 	 	 	 	 	 	 i f   (   ! j $ ( ' . c o n t a c t _ d e t a i l _ p o p ' ) . h a s ( e . t a r g e t ) . l e n g t h   )   {   
 	 	 	 	 	 	 	 	 r e s e t P o p o v e r ( ) ; 
 	 	 	 	 	 	 	 } 
 	 	 	 	 	 	 } ) ; 
 	 	 	 	 	 } ) ; 
 	 	 	 	 } 
 
 	 	 	 	 j $ ( t h i s ) . a d d C l a s s ( ' p r o c e s s e d ' ) ; 
 	 	 	 } ) ; 
 
 	 	 } ) ; 
 
 	 	 / /   i n i t i a l i z e   d e f a u l t   s u g g e s t e d   c o n t a c t s 
 	 	 j $ ( " # s u g g e s t i o n s " ) . s p i n ( { 
 	 	 	 l i n e s :   1 3 ,   / /   T h e   n u m b e r   o f   l i n e s   t o   d r a w 
 	 	 	 l e n g t h :   6 ,   / /   T h e   l e n g t h   o f   e a c h   l i n e 
 	 	 	 w i d t h :   2 ,   / /   T h e   l i n e   t h i c k n e s s 
 	 	 	 r a d i u s :   5 ,   / /   T h e   r a d i u s   o f   t h e   i n n e r   c i r c l e 
 	 	 	 c o l o r :   ' # 5 5 5 '   / /   # r g b   o r   # r r g g b b 
 	 	 } ) ; 
 	 	 j $ . a j a x ( { 
 	 	 	 t y p e :   ' P O S T ' , 
         	 	 u r l :   T V A P P . g u i d ( " / a j a x / c o n t e n t / s u g g e s t e d _ c o n t a c t s ? J o b . i d = " + d a t a . j o b _ i d ) , 
         	 	 d a t a T y p e :   ' j s o n ' , 
         	 	 t i m e o u t :   1 0 0 0 0 , 
         	 	 s u c c e s s :   f u n c t i o n ( r e s p o n s e )   { 
 	 	 	 	 c o n t a c t s L i s t . g e t C o n t e n t P a n e ( ) . h t m l ( r e s p o n s e . R e s u l t ) ; 
 	 	 	 	 b i n d S u g g e s t T o g g l e ( ) ; 
                 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' c o n t a c t L i s t U p d a t e d ' ) ; 
         	 	 } , 
       	   	 	 e r r o r :   f u n c t i o n ( x h r ,   t e x t S t a t u s , e r r o r )   { 
 	 	 	 	 T V A P P . m a s t e r E r r o r H a n d l e r ( x h r ,   t e x t S t a t u s ,   e r r o r ,   n u l l ) ; 
         	 	 } 
 	 	 } ) ; 
 	 	 v a r   b i n d S u g g e s t T o g g l e   =   f u n c t i o n ( )   { 
 	 	 	 j $ ( ' . j S u g g e s t T o g g l e ' ) . c l i c k ( f u n c t i o n ( ) { 
 	 	 	 	 j $ ( t h i s ) . t o g g l e C l a s s ( ' c o l l a p s e d ' ) ; 
 	 	 	 	 v a r   t o g g l e   =   j $ ( t h i s ) . f i n d ( ' . t o g g l e ' ) ; 
 	 	 	 	 t o g g l e . t o g g l e C l a s s ( ' d o w n - a r r o w   u p - a r r o w ' ) ; 
 	 	 	 	 t o g g l e . h a s C l a s s ( ' d o w n - a r r o w ' )   ?   t o g g l e . h t m l ( T V A P P . s m D i c t ( ' e n t y p o . c h e v r o n _ d o w n ' ) )   :   t o g g l e . h t m l ( T V A P P . s m D i c t ( ' e n t y p o . c h e v r o n _ u p ' ) ) ; 
 	 	 	 	 c o n t a c t s L i s t . g e t C o n t e n t P a n e ( ) . f i n d ( ' . j S u g g e s t W r a p ' ) . s t o p ( t r u e , t r u e ) . s l i d e T o g g l e ( 4 0 0 ,   f u n c t i o n ( ) { 
 	 	 	 	 	 c o n t a c t s L i s t . r e i n i t i a l i s e ( ) ; 
 	 	 	 	 } ) ; 
 	 	 	 } ) ; 
 	 	 } ; 
 	 	 
 	 	 / /   h a n d l e   r e s i z e   e v e n t s 
 	 	 v a r   r e s i z e M e s s a g e   =   f u n c t i o n ( )   { 
 	 	 	 / /   r e s i z e   m e s s a g e   b o x   i f   n e e d e d 
 	 	 	 i f   ( j $ ( ' . j C o n t a c t S e a r c h ' ) . o u t e r H e i g h t ( t r u e )   ! =   j $ ( ' . j R e f e r C u s t o m i z e ' ) . o u t e r H e i g h t ( t r u e )   & &   ! j $ ( " b o d y " ) . h a s C l a s s ( " m o b i l e " ) )   { 
 	 	 	 	 j $ ( ' . m e s s a g e _ b o d y ' ) . h e i g h t ( f u n c t i o n   ( i ,   h )   { 
 	 	 	 	 	 r e t u r n   h + j $ ( ' . j C o n t a c t S e a r c h ' ) . o u t e r H e i g h t ( t r u e ) - j $ ( ' . j R e f e r C u s t o m i z e ' ) . o u t e r H e i g h t ( t r u e ) ; 
 	 	 	 	 } ) ; 
 	 	 	 } 
 	 	 	 j $ . c o l o r b o x . r e s i z e ( ) ; 	 
 	 	 } ; 
 	 	 
 	 	 / /   h a n d l e   a d d i n g   c o n t a c t   t o   r e c i p i e n t   l i s t 
 	 	 v a r   p u s h S u g g e s t e d C o n t a c t   =   f u n c t i o n ( c o n t a c t _ v a l u e s )   { 
 	 	 	 v a r   p a r s e d _ v a l u e s   =   j $ . e x t e n d ( J S O N . p a r s e ( c o n t a c t _ v a l u e s ) , { " s i t e _ s t a n d a r d _ p r o f i l e _ u r l " : " " } ) ;   / /   N e e d e d ?   -   J D 
 	 	 	 v a r   c o n t a c t _ e x i s t s   =   f a l s e ; 
 	 	 	 j $ ( c o n t a c t s ) . e a c h ( f u n c t i o n ( )   { 
 	 	 	 	 i f ( t h i s . c h a n n e l _ u s e r _ i d = = p a r s e d _ v a l u e s . c h a n n e l _ u s e r _ i d   & &   t h i s . c h a n n e l _ s h o r t _ n a m e = = p a r s e d _ v a l u e s . c h a n n e l _ s h o r t _ n a m e )   { 
 	 	 	 	 	 c o n t a c t _ e x i s t s   =   t r u e ; 
 	 	 	 	 } 
 	 	 	 } ) ; 
 	 	 	 i f ( ! c o n t a c t _ e x i s t s )   { 
 	 	 	 	 v a r   c o n t a c t _ p i l l   =   j $ ( " < s p a n   c l a s s = ' c o n t a c t ' > " + p a r s e d _ v a l u e s . l a b e l + "   < a   i d = ' " + p a r s e d _ v a l u e s . c h a n n e l _ u s e r _ i d + " '   h r e f = ' # '   c l a s s = ' j A u t o D e l e t e ' > & t i m e s ; < / a > < / s p a n > " ) ; 
 	 	 	 	 c o n t a c t _ p i l l . c h i l d r e n ( ' . j A u t o D e l e t e ' ) . c l i c k ( f u n c t i o n ( e v e n t ) { 
 	 	 	 	 	 e v e n t . p r e v e n t D e f a u l t ( ) ; 
 	 	 	 	 	 e v e n t . s t o p P r o p a g a t i o n ( ) ; 
 	 	 	 	 	 j $ ( c o n t a c t s ) . e a c h ( f u n c t i o n   ( i ,   e )   { 
 	 	 	 	 	 	 i f ( j $ ( e v e n t . c u r r e n t T a r g e t ) . a t t r ( " i d " )   = =   e . c h a n n e l _ u s e r _ i d )   { 
 	 	 	 	 	 	 	 c o n t a c t s . s p l i c e ( i , 1 ) ; 
 	 	 	 	 	 	 } 
 	 	 	 	 	 } ) ; 
 	 	 	 	 	 j $ ( e v e n t . c u r r e n t T a r g e t ) . p a r e n t s ( " . c o n t a c t " ) . r e m o v e ( ) ; 
 	 	 	 	 	 r e s i z e M e s s a g e ( ) ; 
 	 	 	 	 } ) ; 
 	 	 	 	 j $ ( " . j C o n t a c t s L i s t " ) . a p p e n d ( c o n t a c t _ p i l l ) ; 
 	 	 	 	 c o n t a c t s . p u s h ( p a r s e d _ v a l u e s ) ; 
 	 	 	 	 / /   M a k e   s u r e   c o n t a c t   p i l l s   d o n ' t   p r o p o g a t e   t h e   c l i c k   t o   t h e   c o n t a i n e r 
 	 	 	 	 j $ ( " . j C o n t a c t s L i s t   . c o n t a c t " ) . u n b i n d ( ' c l i c k ' ) . b i n d ( ' c l i c k ' , f u n c t i o n ( e )   { 
 	 	 	 	 	 v a r   e v e n t   =   e   | |   w i n d o w . e v e n t ; 
 	 	 	 	 	 e v e n t . s t o p P r o p a g a t i o n ( ) ; 
 	 	 	 	 } ) ; 
 	 	 	 } 
 	 	 	 r e s i z e M e s s a g e ( ) ; 
 	 	 } ; 
 
 	 	 i f ( ! T V A P P . i s E m p t y ( d a t a . s u g g e s t i o n ) )   { 
 	 	 	 p u s h S u g g e s t e d C o n t a c t ( d a t a . s u g g e s t i o n ) ; 
 	 	 } 
 	 
 	 	 / /   c u s t o m i z e   s e a r c h   a u t o c o m p l e t e 
 	 	 j $ . w i d g e t (   " c u s t o m . r e f e r c o m p l e t e " ,   j $ . u i . a u t o c o m p l e t e ,   { 
 	 	 	 _ r e n d e r I t e m :   f u n c t i o n (   u l ,   i t e m   )   { 
 	 	 	 	 i f ( ! j $ ( u l ) . h a s C l a s s ( " r e f - a u t o c o m p l e t e " ) )   { 
 	 	 	 	 	 j $ ( u l ) . a d d C l a s s ( " r e f - a u t o c o m p l e t e " ) ; 
 	 	 	 	 } 
 
 	 	 	 	 j $ ( " . j S u g g e s t e d H o l d e r " ) . c s s ( " o p a c i t y " , " 0 . 2 5 " ) ; 
 
 	 	 	 	 v a r   a v a t a r   =   ( i t e m . a v a t a r   ! =   " " )   ?   i t e m . a v a t a r   :   " / i m a g e s / a v a t a r _ p l a c e h o l d e r . j p g " ; 
 	 	 	 	 v a r   l a b e l   =   ( i t e m . l a b e l   ! =   " " )   ?   i t e m . l a b e l   :   " " ; 
 
 	 	 	 	 v a r   c h a n n e l _ s h o r t _ n a m e   =   ( i t e m . c h a n n e l _ s h o r t _ n a m e   ! =   " " )   ?   i t e m . c h a n n e l _ s h o r t _ n a m e   :   " " ; 
 
 	 	 	 	 v a r   h e a d l i n e   =   ( i t e m . h e a d l i n e   ! =   " " )   ?   i t e m . h e a d l i n e   :   " " ; 
 
 	 	 	 	 i f   ( j $ ( " b o d y " ) . h a s C l a s s ( " m o b i l e " )   & &   h e a d l i n e . i n d e x O f ( "   a t   "   = = =   - 1 ) )   { 
 	 	 	 	 	 v a r   h e a d l i n e M o b i l e   =   h e a d l i n e . s p l i t ( "   a t   " ) . j o i n ( ' < b r > a t   ' ) ; 
 	 	 	 	 	 h e a d l i n e   =   h e a d l i n e M o b i l e ; 
 	 	 	 	 } 
 	 	 	 	 
 	 	 	 	 v a r   t m p   =   j $ (   ' < l i   c l a s s = " l i _ c o n t a c t " > < / l i > ' ) 
 	 	 	 	 	 . a p p e n d (   " < a   h r e f = ' # ' > < i m g   s r c = ' "   +   a v a t a r   +   " '   c l a s s = ' a v a t a r _ i m g '   / > "   +   l a b e l   +   " < b r   / > < s p a n   c l a s s = ' c o n t a c t _ j o b _ t i t l e ' > "   +   h e a d l i n e   +   " < / s p a n > < / a > "   ) ; 
 	 	 	 	 
 	 	 	 	 t m p . d a t a (   " u i - a u t o c o m p l e t e - i t e m " ,   i t e m   ) . a p p e n d T o (   u l   ) ; 
 	 	 	 	 
 	 	 	 	 r e t u r n   t m p ; 	 
 	 	 	 	 	 
 	 	 	 } 
 	 	 } ) ; 
 
 	 	 / /   a d d   s e a r c h   a u t o c o m p l e t e 
 	 	 j $ ( ' # j L i C o n t a c t s ' ,   m o d a l ) 
 	 	 	 . r e f e r c o m p l e t e ( { 
 	 	 	 	 m i n L e n g t h :   2 , 
 	 	 	 	 a p p e n d T o :   ' . j C o n t a c t S e a r c h ' , 
 	 	 	 	 s o u r c e :   f u n c t i o n ( r e q u e s t ,   r e s p o n s e )   { 
 	 	 	 	 	 / /   d e l e g a t e   b a c k   t o   a u t o c o m p l e t e ,   b u t   e x t r a c t   t h e   l a s t   t e r m 
 	 	 	 	 	 v a r   t e r m s   =   r e q u e s t . t e r m . s p l i t ( / , \ s * / ) , 
 	 	 	 	 	 	 l a s t   =   t e r m s . p o p ( ) , 
 	 	 	 	 	 	 I N c o n t a c t s   =   n e w   A r r a y ( ) ; 
 	 	 	 	 	 j $ . l o g ( " R E Q U E S T :   "   +   J S O N . s t r i n g i f y ( l a s t ) ) ; 
 	 	 	 	 	 / /   f i l t e r   c o n t a c t s   t o   o n l y   b e   l i n k e d i n   c o n t a c t s 
 	 	 	 	 	 j $ . e a c h ( T V A P P . u s e r . g e t C o n t a c t s ( ) ,   f u n c t i o n ( i d x ,   r e s u l t )   { 
 	 	 	 	 	 	 i f ( r e s u l t . c h a n n e l _ s h o r t _ n a m e   = =   " l i n k e d i n " )   { 
 	 	 	 	 	 	 	 I N c o n t a c t s . p u s h ( r e s u l t ) ; 
 	 	 	 	 	 	 } 
 	 	 	 	 	 } ) ; 
 	 	 	 	 	 
 	 	 	 	 	 j $ . l o g ( " L i n k e d I n   S u g g e s t   O b j e c t :   "   +   J S O N . s t r i n g i f y ( I N c o n t a c t s ) ) ; 
 	 	 	 	 	 
 	 	 	 	 	 v a r   r e s u l t s   =   j $ . u i . a u t o c o m p l e t e . f i l t e r ( I N c o n t a c t s ,   l a s t ) ; 
 	 	 	 	 	 r e s p o n s e ( r e s u l t s . s l i c e ( 0 , 4 ) ) ; 
 	 	 	 	 	 
 	 	 	 	 	 j $ . l o g ( " S e r i a l i z e d   S u g g e s t   O b j e c t :   "   +   J S O N . s t r i n g i f y ( r e s u l t s ) ) ; 
 	 	 	 	 	 
 	 	 	 	 } , 
 	 	 	 	 f o c u s :   f u n c t i o n ( e v e n t ,   u i )   { 
 	 	 	 	 	 r e t u r n   f a l s e ; 
 	 	 	 	 } , 
 	 	 	 	 s e l e c t :   f u n c t i o n ( e v e n t ,   u i )   { 
 	 	 	 	 	 e v e n t . p r e v e n t D e f a u l t ( ) ; 
 	 	 	 	 	 j $ ( " . j S u g g e s t e d H o l d e r " ) . c s s ( " o p a c i t y " , " 1 . 0 " ) ; 
 	 	 	 	 	 p u s h S u g g e s t e d C o n t a c t ( J S O N . s t r i n g i f y ( u i . i t e m ) ) ; 
 	 	 	 	 	 r e t u r n   f a l s e ; 
 	 	 	 	 } 
 	 	 	 } ) ; 
 	 	 	 
 	 	 / /   s u b m i t   f o r m   w i t h   e n t e r 
 	 	 j $ ( ' . j S e a r c h C o n t a c t s ' ,   m o d a l ) 
 	 	 	 . k e y d o w n ( f u n c t i o n ( e )   { 
 	 	 	 	 i f ( e . w h i c h   = =   1 3   & &   ! j $ ( " . u i - s t a t e - h o v e r " ) . l e n g t h )   { 
 	 	 	 	 	 j $ ( t h i s ) . b l u r ( ) . f o c u s ( ) ; 
 	 	 	 	 	 j $ ( " . j S u g g e s t e d H o l d e r " ) . c s s ( " o p a c i t y " , " 1 . 0 " ) ; 
 	 	 	 	 	 j $ ( " . j C o n t a c t S e a r c h S u b m i t " ) . t r i g g e r ( " c l i c k " ) ; 
 	 	 	 	 } 
 	 	 	 } ) 
 	 	 	 . b l u r ( f u n c t i o n ( ) { 
 	 	 	 	 j $ ( " . j S u g g e s t e d H o l d e r " ) . c s s ( " o p a c i t y " , " 1 . 0 " ) ; 
 	 	 	 } ) ; 
 
 	 	 / /   t e x t a r e a   a u t o s i z e 	 	 
 	 	 j $ ( " . j M e s s a g e B o d y " ) . a u t o s i z e ( ) ; 
 
 	 	 / /   a d d   c o n t a c t s   i n f i n i t e   s c r o l l   f u n c t i o n a l i t y 
 	 	 v a r   r e a d y F o r M o r e   =   t r u e ; 
 	 	 f u n c t i o n   l o a d M o r e C o n t a c t s ( )   { 
 	 	 	 v a r   p a g e I n d e x   =   p a r s e I n t ( j $ ( " i n p u t [ n a m e = ' p a g e _ i n d e x ' ] " ) . v a l ( ) ) ; 
 	 	 	 i f (   p a g e I n d e x   <   p a r s e I n t ( j $ ( " i n p u t [ n a m e = ' n u m _ p a g e s ' ] " ) . v a l ( ) ) )   { 
 	 	 	 	 v a r   p a r a m s   =   { k e y w o r d s : j $ ( ' # j K e y w o r d s ' ) . v a l ( ) , s o c i a l _ c h a n n e l s : ' [ " l i n k e d i n " ] ' , p a g e _ i n d e x : p a g e I n d e x + 1 } ; 
 	 	 	 	 j $ . a j a x ( { 
 	 	 	 	 	 t y p e :   ' P O S T ' , 
 	 	 	 	 	 u r l :   T V A P P . g u i d ( ' / a j a x / s e a r c h - c o n t a c t s ' ) , 
 	 	 	 	 	 d a t a :   j $ . p a r a m ( p a r a m s ) , 
 	 	 	 	 	 s u c c e s s :   f u n c t i o n ( r e s p o n s e ) { 
 	 	 	 	 	 	 j $ ( " . j L o a d M o r e " ) . r e m o v e ( ) ; 
 	 	 	 	 	 	 c o n t a c t s L i s t . g e t C o n t e n t P a n e ( ) 
 	 	 	 	 	 	 	 . a p p e n d ( r e s p o n s e . R e s u l t ) 
 	 	 	 	 	 	 	 . a p p e n d ( " < d i v   c l a s s = ' j L o a d M o r e ' > < / d i v > " ) ; 
 	 	 	 	 	 	 j $ ( ' . j L o a d M o r e ' ) . s p i n ( ) ; 
 	 	 	 	 	 	 j $ ( ' . j K e y w o r d s ' ,   m o d a l ) . t e x t ( p a r a m s . k e y w o r d s ) ; 
 	 	 	 	 	 	 j $ ( " i n p u t [ n a m e = ' p a g e _ i n d e x ' ] " ) . v a l ( p a g e I n d e x + 1 ) ; 
 	 	 	 	 	 	 r e a d y F o r M o r e   =   t r u e ; 
 	 	 	 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' c o n t a c t L i s t U p d a t e d ' ) ; 
 	 	 	 	 	 } , 
 	 	 	 	 	 d a t a T y p e :   ' j s o n ' , 
 	 	 	 	 	 e r r o r :   f u n c t i o n ( x h r ,   t e x t S t a t u s ,   e r r o r )   {   T V A P P . m a s t e r E r r o r H a n d l e r ( x h r ,   t e x t S t a t u s ,   e r r o r ,   n u l l ) ;   } 
 	 	 	 	 } ) ; 
 	 	 	 }   e l s e   { 
 	 	 	 	 j $ ( " . j L o a d M o r e " ) . r e m o v e ( ) ; 
 	 	 	 	 r e a d y F o r M o r e   =   t r u e ; 
 	 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' c o n t a c t L i s t U p d a t e d ' ) ; 
 	 	 	 } 
 	 	 } 
 	 
 	 	 f u n c t i o n   i s S c r o l l e d I n t o V i e w ( e l e m )   { 
 	 	         v a r   d o c V i e w T o p   =   j $ ( w i n d o w ) . s c r o l l T o p ( ) ; 
 	 	         v a r   d o c V i e w B o t t o m   =   d o c V i e w T o p   +   j $ ( w i n d o w ) . h e i g h t ( ) ; 
 	 	         v a r   e l e m T o p   =   j $ ( e l e m ) . o f f s e t ( ) . t o p ; 
 	 	         v a r   e l e m B o t t o m   =   e l e m T o p   +   j $ ( e l e m ) . h e i g h t ( ) ; 
 	 	         r e t u r n   ( ( e l e m B o t t o m   > =   d o c V i e w T o p )   & &   ( e l e m T o p   < =   d o c V i e w B o t t o m ) ) ; 
 	 	 } 
 	 	 
 	 } ; 
 	 
 	 v a r   h a n d l e L i n k e d I n M e s s a g e S u b m i t   =   f u n c t i o n ( t h e F o r m ,   c o n t a c t s )   { 
 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k E v e n t " ,   {   a c t i o n :   " S e n d   M e s s a g e " ,   l a b e l :   ' j R e f e r S o m e C o n t a c t s '   } ) ; 
 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k P a g e " ,   {   u r l :   " / g a / a j a x / r e f e r / S e n d M e s s a g e " } ) ; 
 
 	 	 j $ ( " i n p u t [ n a m e = ' M e s s a g e . c o n t a c t s ' ] " ) . v a l (   J S O N . s t r i n g i f y ( c o n t a c t s )   ) ; 
 
 	 	 / /   A d d   l o a d i n g   a n i m a t i o n 
 	 	 T V A P P . m o d a l . l o a d i n g S t a r t ( ) ; 
 	 	 
 	 	 / /   P o s t   m e s s a g e   f o r m 
 	 	 j $ . a j a x ( { 
 	 	 	 t y p e :   ' P O S T ' , 
 	 	 	 c o n t e n t T y p e :   " a p p l i c a t i o n / j s o n ;   c h a r s e t = u t f - 8 " , 
 	 	 	 u r l :   T V A P P . g u i d ( t h e F o r m . a t t r ( ' a c t i o n ' ) ) , 
 	 	 	 d a t a :   J S O N . s t r i n g i f y ( t h e F o r m . s e r i a l i z e O b j e c t ( ) ) , 
 	 	 	 c o n t e n t T y p e :   " a p p l i c a t i o n / j s o n ;   c h a r s e t = u t f - 8 " , 
 	 	 	 d a t a T y p e :   ' j s o n ' , 
 	 	 	 s u c c e s s :   f u n c t i o n ( r e s u l t )   {   
 	 	 	 	 i f ( r e s u l t . S t a t u s   = =   " O K " )   { 
 	 	 	 	 	 v a r   u s e r M e s s a g e   =   r e s u l t . U s e r M e s s a g e ; 
 	 	 	 	 	 j $ ( " b o d y " ) . m o d a l ( { 
 	 	 	 	 	 	 " t e x t " : u s e r M e s s a g e , 
 	 	 	 	 	 	 " o n C l o s e " :   f u n c t i o n ( )   {   T V A P P . m o d a l . c l o s e ( t r u e ) ;   } 
 	 	 	 	 	 } ) ; 
 	 	 	 	 }   e l s e   { 
 	 	 	 	 	 j $ . l o g ( r e s u l t . E r r o r s . G E N E R I C _ E R R O R _ S T R I N G ) ; 
 	 	 	 	 } 
 	 	 	 } , 
 	 	 	 e r r o r :   f u n c t i o n ( x h r ,   t e x t S t a t u s ,   e r r o r )   {   T V A P P . m a s t e r E r r o r H a n d l e r ( x h r ,   t e x t S t a t u s ,   e r r o r ,   n u l l ) ;   } , 
 	 	 	 c o m p l e t e :   f u n c t i o n ( )   {   
 	 	 	 	 T V A P P . m o d a l . l o a d i n g S t o p ( ) ; 
 	 	 	 } 
 	 	 } ) ; 
 	 } ; 
 
 	 j $ ( d o c u m e n t ) . b i n d ( ' l i n k e d i n M e s s a g e ' ,   h a n d l e L i n k e d i n M e s s a g e ) ; 
 	 j $ ( d o c u m e n t ) . b i n d ( ' l i n k e d i n _ m e s s a g e _ m o d a l _ i n i t ' ,   h a n d l e L i n k e d i n M e s s a g e M o d a l I n i t i a l i z e ) ; 
 
 	 v a r   h a n d l e F a c e b o o k M e s s a g e   =   f u n c t i o n ( e ,   d a t a )   { 
 	 	 d a t a   =   d a t a   | |   { } ; 
 	 	 j $ . e x t e n d ( d a t a ,   {   m o d e : " f a c e b o o k M e s s a g e "   } ) ; 
 	 	 / /   i f   n o t   r e g i s t e r e d   o p e n   r e g i s t r a t i o n   m o d a l   &   s e t   n e x t 
 	 	 i f   ( T V A P P . u s e r . g e t R e g S t a t u s ( )   = =   " u n r e g i s t e r e d " )   { 
 	 	 	 / /   s e t   n e x t   a c t i o n   a n d   r e d i r e c t   t o   r e g i s t e r 
 	 	 	 j $ . l o g ( ' - >   R e d i r e c t   t o   r e g i s t e r ' ) ; 
 	 	 	 T V A P P . m o d a l . p r o c e e d   =   f a l s e ; 
 	 	 	 T V A P P . m o d a l . n e x t A c t i o n   =   f u n c t i o n ( )   {   j $ ( d o c u m e n t ) . t r i g g e r ( ' f a c e b o o k M e s s a g e ' , d a t a ) ;   } ; 
 	 	 	 j $ ( d o c u m e n t ) . b i n d ( " u s e r I n f o U p d a t e d . m o d a l . f a c e b o o k " ,   f u n c t i o n ( )   { 
 	 	 	 	 i f ( T V A P P . u s e r . g e t R e g S t a t u s ( )   ! =   " u n r e g i s t e r e d " )   { 
 	 	 	 	 	 j $ . l o g ( ' < -   R e a t t e m p t   f a c e b o o k   m e s s a g e ' ) ; 
 	 	 	 	 	 T V A P P . m o d a l . p r o c e e d   =   t r u e ; 
 	 	 	 	 	 T V A P P . m o d a l . c l o s e ( ) ; 
 	 	 	 	 	 j $ ( d o c u m e n t ) . u n b i n d ( ' . f a c e b o o k ' ) ; 
 	 	 	 	 } 
 	 	 	 } ) ; 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' r e g i s t e r M o d a l ' ,   d a t a ) ; 
 	 	 / /   o p e n   f a c e b o o k   m e s s a g e   d i a l o g 
 	 	 }   e l s e   { 
 	 	 	 T V A P P . u s e r . u p d a t e R e f e r r e r C o d e P r e f i x ( f u n c t i o n ( ) { 
 	 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' f a c e b o o k S e n d D i a l o g ' ,   d a t a ) ; 
 	 	 	 } ) ; 
 	 	 } 
 	 } ; 
 	 
 	 v a r   h a n d l e F a c e b o o k S e n d D i a l o g   =   f u n c t i o n ( e , d a t a )   { 
 	 	 d a t a   =   d a t a   | |   { } ; 
 	 	 T V A P P . m o d a l . c l o s e ( t r u e ) ;   / /   s i n c e   w e   a r e   d o i n g   f a c e b o o k   i n   t h e   n a t i v e   F B   d i a l o g   m o d a l 
 	 	 j $ . l o g ( ' O p e n   F a c e b o o k   M e s s a g e   D i a l o g :   ' + T V A P P . p r o p e r t y . s i t e _ n a m e + T V A P P . p r o p e r t y . r e f e r r e r _ c o d e _ p r e f i x + ' / j o b s / ' + d a t a . j o b _ i d ) ; 
 	 	 i f ( F B ) { 
 	 	 	 F B . u i ( { 
 	 	 	 	 m e t h o d :   ' s e n d ' , 
 	 	 	 	 n a m e :   j $ ( ' m e t a [ p r o p e r t y = " o g \ \ : t i t l e " ] ' ) . a t t r ( " c o n t e n t " ) , 
 	 	 	 	 d e s c r i p t i o n :   j $ ( ' m e t a [ p r o p e r t y = " o g \ \ : d e s c r i p t i o n " ] ' ) . a t t r ( " c o n t e n t " ) , 
 	 	 	 	 p i c t u r e :   j $ ( ' l i n k [ r e l = " i m a g e _ s r c " ] ' ) . a t t r ( " h r e f " ) , 
 	 	 	 	 l i n k :   ( T V A P P . p r o p e r t y . d e m o _ m o d e   ?   T V A P P . p r o p e r t y . d e m o _ u r l + ' / j o b s / 2 3 7 1 6 '   :   T V A P P . p r o p e r t y . s i t e _ n a m e + T V A P P . p r o p e r t y . r e f e r r e r _ c o d e _ p r e f i x + ' / j o b s / ' + d a t a . j o b _ i d ) , 
 	 	 	 	 s h o w _ e r r o r :   ' t r u e ' 
 	 	 	 } , 
 	 	 	 f u n c t i o n ( r e s p o n s e )   { 
 	 	 	 	 r e s p o n s e   =   r e s p o n s e   | |   { } ;   / /   a v o i d   e r r o r   f o r   c l o s i n g 
 	 	 	 	 i f   ( r e s p o n s e . s u c c e s s )   { 
 	 	 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k E v e n t " ,   {   a c t i o n :   " S e n d   M e s s a g e " ,   l a b e l :   ' j R e f e r S o m e C o n t a c t s '   } ) ; 
 	 	 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k P a g e " ,   {   u r l :   " / g a / a j a x / r e f e r / S e n d M e s s a g e " } ) ; 
 	 	 	 	 	 / /   t r i g g e r   a c t i o n   t o   a d d   t h i s   s h a r e   t o   a c t i v i t y   f e e d   a n d   a n a l y t i c s   t r a c k i n g 
 	 	 	 	 	 j $ . p o s t ( 
 	 	 	 	 	 	 T V A P P . g u i d ( " / a j a x / j o b s / " + d a t a . j o b _ i d + " / r e f e r " ) , 
 	 	 	 	 	 	 {   " M e s s a g e . m o d e " : " p e r s o n a l _ m e s s a g e " ,   " M e s s a g e . b r o a d c a s t _ c h a n n e l s " : " [ ' f a c e b o o k ' ] " } , 
 	 	 	 	 	 	 ' j s o n ' 
 	 	 	 	 	 ) ; 
 	 	 	 	 	 j $ ( " b o d y " ) . m o d a l ( { 
 	 	 	 	 	 	 " t e x t " : T V A P P . s m D i c t ( ' R e f e r . M o d a l . F a c e b o o k . s u c c e s s ' ) 
 	 	 	 	 	 } ) ; 
 	 	 	 	 }   e l s e   { 
 	 	 	 	 	 j $ . l o g ( ' F a c e b o o k   M e s s a g e   C a n c e l l e d ' ) ; 
 	 	 	 	 } 
 	 	 	 } ) ; 
 	 	 }   e l s e   { 
 	 	 	 T V A P P . f a c e b o o k _ l o a d i n g ( ) ; 
 	 	 } 
 	 } ; 
 
 	 j $ ( d o c u m e n t ) . b i n d ( ' f a c e b o o k M e s s a g e ' ,   h a n d l e F a c e b o o k M e s s a g e ) ; 
 	 j $ ( d o c u m e n t ) . b i n d ( ' f a c e b o o k S e n d D i a l o g ' ,   h a n d l e F a c e b o o k S e n d D i a l o g ) ; 
 	 
 	 
 	 
 	 v a r   h a n d l e W e i b o S t a t u s U p d a t e   =   f u n c t i o n ( e ,   d a t a )   { 
 	 	 d a t a   =   d a t a   | |   { } ; 
 	 	 j $ . e x t e n d ( d a t a ,   {   m o d e : " w e i b o M e s s a g e " ,   r e g i s t r a t i o n T y p e : " w e i b o "   } ) ; 
 	 	 / /   i f   n o t   r e g i s t e r e d   o p e n   r e g i s t r a t i o n   m o d a l   &   s e t   n e x t 
 	 	 i f   ( T V A P P . u s e r . g e t R e g S t a t u s ( )   = =   " u n r e g i s t e r e d " )   { 
 	 	 	 / /   s e t   n e x t   a c t i o n   a n d   r e d i r e c t   t o   r e g i s t e r 
 	 	 	 j $ . l o g ( ' - >   R e d i r e c t   t o   r e g i s t e r ' ) ; 
 	 	 	 T V A P P . m o d a l . p r o c e e d   =   f a l s e ; 
 	 	 	 T V A P P . m o d a l . n e x t A c t i o n   =   f u n c t i o n ( )   {   j $ ( d o c u m e n t ) . t r i g g e r ( ' w e i b o S t a t u s ' , d a t a ) ;   } ; 
 	 	 	 j $ ( d o c u m e n t ) . b i n d ( " u s e r I n f o U p d a t e d . m o d a l . w e i b o " ,   f u n c t i o n ( )   { 
 	 	 	 	 i f ( T V A P P . u s e r . g e t R e g S t a t u s ( )   ! =   " u n r e g i s t e r e d " )   { 
 	 	 	 	 	 j $ . l o g ( ' < -   R e a t t e m p t   w e i b o   m e s s a g e ' ) ; 
 	 	 	 	 	 T V A P P . m o d a l . p r o c e e d   =   t r u e ; 
 	 	 	 	 	 T V A P P . m o d a l . c l o s e ( ) ; 
 	 	 	 	 	 j $ ( d o c u m e n t ) . u n b i n d ( ' . w e i b o ' ) ; 
 	 	 	 	 } 
 	 	 	 } ) ; 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' r e g i s t e r M o d a l ' ,   d a t a ) ; 
 	 	 / /   o p e n   f a c e b o o k   m e s s a g e   d i a l o g 
 	 	 }   e l s e   { 
 	 	 	 T V A P P . u s e r . u p d a t e R e f e r r e r C o d e P r e f i x ( f u n c t i o n ( ) { 
 	 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' w e i b o S t a t u s D i a l o g ' ,   d a t a ) ; 
 	 	 	 } ) ; 
 	 	 } 
 	 } ; 
 	 
 	 v a r   h a n d l e W e i b o S t a t u s D i a l o g   =   f u n c t i o n ( e , d a t a )   { 
 	 	 d a t a   =   d a t a   | |   { } ; 
 	 	 T V A P P . m o d a l . o p e n ( " w e i b o _ s t a t u s _ m o d a l " ,   { } ,   d a t a ) ; 
 	 } ; 
 	 
 	 v a r   h a n d l e W e i b o S t a t u s I n i t i a l i z e   =   f u n c t i o n ( e , d a t a )   { 
 	 	 d a t a   =   d a t a   | |   { } ; 
 	 	 v a r   m o d a l   =   j $ ( ' # c b o x L o a d e d C o n t e n t ' ) ; 
 	 	 
 	 	 / / B e w a r e   a l l   y e   w h o   e n t e r   -   W e i b o   b r e a k s   o u t   o f   i f r a m e s   -   E v a n 
 	 	 / * T V A P P . m o d a l . o p e n ( ' w e i b o _ s t a t u s _ r e d i r e c t ' ,   { w i d t h : " 8 4 0 p x " ,   h e i g h t : " 8 4 0 p x " ,   i n n e r W i d t h :   t h i s . w i d t h ,   i n n e r H e i g h t : t h i s . h e i g h t + 4 4 ,   m a x W i d t h : f a l s e ,   s c r o l l i n g : t r u e } ,   { u r l :   s t a t u s _ u r l ,   i f r a m e H e i g h t : t h i s . h e i g h t } ) ; * / 
 	 	 
 	 	 v a r   c u r r e n t _ u r l   =   e n c o d e U R I C o m p o n e n t ( T V A P P . p r o p e r t y . s i t e _ n a m e + T V A P P . p r o p e r t y . r e f e r r e r _ c o d e _ p r e f i x + ' / j o b s / ' + d a t a . j o b _ i d ) ; 
 	 	 
 	 	 j $ . g e t J S O N ( " / a j a x / l i n k s / r e f e r " , { 
 	 	 	 " u r l " : ' / j o b s / ' + d a t a . j o b _ i d , 
 	 	 	 " s o c i a l _ c h a n n e l _ n a m e " : " w e i b o " 
 	 	 } ,   f u n c t i o n ( d a t a ) { 
 	 	 	 c u r r e n t _ u r l   =   d a t a . U s e r M e s s a g e ; 
 	 	 } ) ; 
 	 	 
 	 	 j $ ( " . j W e i b o S t a t u s L a u n c h " , m o d a l ) . c l i c k ( f u n c t i o n ( e ) { 
 	 	 	 T V A P P . m o d a l . c l o s e ( t r u e ) ;   / /   s i n c e   w e   a r e   d o i n g   f a c e b o o k   i n   t h e   n a t i v e   F B   d i a l o g   m o d a l 
 	 	 	 j $ . l o g ( ' O p e n   W e i b o   S t a t u s   D i a l o g :   ' + T V A P P . p r o p e r t y . s i t e _ n a m e + T V A P P . p r o p e r t y . r e f e r r e r _ c o d e _ p r e f i x + ' / j o b s / ' + d a t a . j o b _ i d ) ; 
 	 	 	 
 	 	 	 / / v a r   s t a t u s _ u r l   =   " h t t p : / / s e r v i c e . w e i b o . c o m / s h a r e / s h a r e . p h p ? u r l = "   +   e n c o d e U R I C o m p o n e n t ( c u r r e n t _ u r l )   +   " & t i t l e = "   +   e n c o d e U R I C o m p o n e n t ( j $ ( ' m e t a [ p r o p e r t y = " o g \ \ : t i t l e " ] ' ) . a t t r ( " c o n t e n t " ) ) ; 
 	 	 	 v a r   s t a t u s _ u r l   =   " h t t p : / / s e r v i c e . w e i b o . c o m / s h a r e / s h a r e . p h p ? u r l = "   +   e n c o d e U R I C o m p o n e n t ( c u r r e n t _ u r l )   +   " & t i t l e = "   +   e n c o d e U R I C o m p o n e n t ( T V A P P . s m D i c t ( " R e f e r . W e i b o . l i t e . m e s s a g e " ) ) ; 
 	 	 	 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k E v e n t " ,   {   a c t i o n :   " S t a t u s   U p d a t e " ,   l a b e l :   ' j S t a t u s W e i b o '   } ) ; 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k P a g e " ,   {   u r l :   " / g a / a j a x / r e f e r / S t a t u s W e i b o " } ) ; 
 	 	 	 
 	 	 	 / / W i n d o w   V e r s i o n   - > 
 	 	 	 v a r   c u r r W i n X   =   ( d o c u m e n t . a l l )   ?   w i n d o w . s c r e e n L e f t   :   w i n d o w . s c r e e n X ; 
 	 	 	 v a r   c u r r W i n Y   =   ( d o c u m e n t . a l l )   ?   w i n d o w . s c r e e n T o p   :   w i n d o w . s c r e e n Y ; 
 	 	 	 c u r r W i n X   + =   2 4 0 ; 
 	 	 	 c u r r W i n Y   + =   2 7 5 ; 
 	 	 	 w i n d o w . o p e n ( 
 	 	 	 	 s t a t u s _ u r l ,   " t e t h e r " ,   " w i d t h = " +   6 5 1   + " ,   h e i g h t = " +   3 9 9   + " ,   t o o l b a r = n o ,   r e s i z a b l e = y e s ,   " + 
 	 	 	 	 " l o c a t i o n = n o ,   d i r e c t o r i e s = n o ,   s t a t u s = n o ,   m e n u b a r = n o ,   c o p y h i s t o r y = n o ,   "   + 
 	 	 	 	 " l e f t = " +   c u r r W i n X   + " ,   t o p = " +   c u r r W i n Y   + " ,   s c r e e n X = " +   c u r r W i n X   + " ,   s c r e e n Y = " +   c u r r W i n Y 
 	 	 	 ) ; 
 	 	 } ) ; 
 	 } ; 
 	 
 	 
 	 j $ ( d o c u m e n t ) . b i n d ( ' w e i b o S t a t u s ' ,   h a n d l e W e i b o S t a t u s U p d a t e ) ; 
 	 j $ ( d o c u m e n t ) . b i n d ( ' w e i b o S t a t u s D i a l o g ' ,   h a n d l e W e i b o S t a t u s D i a l o g ) ; 
 	 j $ ( d o c u m e n t ) . b i n d ( ' w e i b o _ s t a t u s _ m o d a l _ i n i t ' ,   h a n d l e W e i b o S t a t u s I n i t i a l i z e ) ; 
 	 
 	 
 	 / *   - -   R e m o v e ,   a d d e d   g l o b a l   b i n d i n g   i n   d e s k t o p . j s 
 	 v a r   h a n d l e R e f e r r a l L i n k   =   f u n c t i o n ( e , d a t a )   { 
 	 	 d a t a   =   d a t a   | |   { } ; 
 	 	 j $ . e x t e n d ( d a t a ,   {   m o d e : " r e f e r r a l L i n k "   } ) ; 
 	 	 / /   i f   l i k e l y   u n r e g i s t e r e d   o p e n   r e g i s t r a t i o n   m o d a l   &   s e t   n e x t 
 	 	 i f   ( T V A P P . u s e r . g e t I s G u e s t ( )   = =   ' t r u e '   & &   T V A P P . u s e r . l i k e l y U s e r . g e t I s G u e s t ( )   = =   ' t r u e ' )   {   / /   p a r t i a l l y   l o g g e d   i n   i s   o k 
 	 	 	 / /   s e t   n e x t   a c t i o n   a n d   r e d i r e c t   t o   r e g i s t e r 
 	 	 	 j $ . l o g ( ' - >   R e d i r e c t   t o   r e g i s t e r ' ) ; 
 	 	 	 T V A P P . m o d a l . p r o c e e d   =   f a l s e ; 
 	 	 	 T V A P P . m o d a l . n e x t A c t i o n   =   f u n c t i o n ( )   {   j $ ( d o c u m e n t ) . t r i g g e r ( ' r e f e r r a l L i n k ' , d a t a ) ;   } ; 
 	 	 	 j $ ( d o c u m e n t ) . b i n d ( " u s e r I n f o U p d a t e d . m o d a l . l i n k " ,   f u n c t i o n ( )   { 
 	 	 	 	 i f ( T V A P P . u s e r . g e t R e g S t a t u s ( )   ! =   " u n r e g i s t e r e d " )   { 
 	 	 	 	 	 j $ . l o g ( ' < -   R e a t t e m p t   r e f e r r a l   l i n k ' ) ; 
 	 	 	 	 	 T V A P P . m o d a l . p r o c e e d   =   t r u e ; 
 	 	 	 	 	 T V A P P . m o d a l . c l o s e ( ) ; 
 	 	 	 	 	 j $ ( d o c u m e n t ) . u n b i n d ( ' . l i n k ' ) ; 
 	 	 	 	 } 
 	 	 	 } ) ; 
 	 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( ' r e g i s t e r M o d a l ' ,   d a t a ) ; 
 	 	 / /   e l s e   l o a d   r e f e r a l   l i n k   m o d a l 
 	 	 }   e l s e   { 
 	 	 	 T V A P P . m o d a l . o p e n ( ' r e f e r r a l _ l i n k _ m o d a l ' ,   { } ,   d a t a ) ; 
 	 	 } 
 	 } ; 
 
 	 v a r   h a n d l e R e f e r r a l L i n k M o d a l I n i t i a l i z e   =   f u n c t i o n ( e , d a t a )   { 
 	 	 / /   t r a c k i n g 
 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k E v e n t " ,   {   a c t i o n :   " G r a b   T h e   L i n k " ,   l a b e l :   ' j C l i p M o d a l O p e n '   } ) ; 
 	 	 j $ ( d o c u m e n t ) . t r i g g e r ( " t r a c k P a g e " ,   {   u r l :   " / g a / a j a x / r e f e r / G r a b T h e L i n k " } ) ; 
 
 	 	 / /   l o c a l   v a r i a b l e s 
 	 	 v a r   m o d a l   =   j $ ( ' # c b o x L o a d e d C o n t e n t ' ) , 
 	 	 	 s h o r t U r l   =   ' ' , 
 	 	 	 r e f _ c l i p   =   n e w   Z e r o C l i p b o a r d . C l i e n t ( ) ; 
 
 	 	 / /   U p d a t e   R e f e r r a l   L i n k 
 	 	 j $ . p o s t ( 
 	 	 	 T V A P P . g u i d ( ' / a j a x / j o b _ s h o r t _ u r l ' ) , 
 	 	 	 {   " J o b . i d "   :   d a t a . j o b _ i d   } , 
 	 	 	 f u n c t i o n ( r e s u l t )   { 
 	 	 	 	 i f ( r e s u l t . S t a t u s   = =   " O K " )   { 
 	 	 	 	 	 s h o r t U r l   =   r e s u l t . R e s u l t . j o b _ s h o r t _ u r l . t o S t r i n g ( ) ; 
 	 	 	 	 	 r e f _ c l i p . s e t T e x t ( s h o r t U r l ) ; 
 	 	 	 	 	 j $ ( " . j S h o r t L i n k " , m o d a l ) . v a l ( s h o r t U r l ) ; 
 	 	 	 	 	 r e f _ c l i p . g l u e ( j $ ( ' . j C o p y B t n ' , m o d a l ) [ 0 ] ,   j $ ( ' . j C o p y B t n ' , m o d a l ) . p a r e n t ( ) [ 0 ] ) ; 
 	 	 	 	 }   e l s e   { 
 	 	 	 	 	 s h o r t U r L   =   r e s u l t . E r r o r . G e n e r a l E r r o r ; 
 	 	 	 	 } 
 	 	 	 } , 
 	 	 	 ' j s o n ' 
 	 	 ) ; 
 
 	 	 / /   A d d   z e r o c l i p b o a r d   c o p y   l i n k   c a l l b a c k 
 	 	 r e f _ c l i p . a d d E v e n t L i s t e n e r (   ' o n C o m p l e t e ' ,   
 	 	 	 f u n c t i o n ( c l i e n t ,   t e x t )   { 
 	 	 	 	 j $ . l o g ( " C o p i e d   l i n k   t o   c l i p b o a r d :   "   +   t e x t   ) ; 
 	 	 	 	 j $ ( " b o d y " ) . m o d a l ( { 
 	 	 	 	 	 " t e x t " : T V A P P . s m D i c t ( ' R e f e r . M o d a l . L i n k . s u c c e s s ' ) ,   
 	 	 	 	 	 o n C l o s e :   T V A P P . m o d a l . c l o s e ( t r u e ) 
 	 	 	 	 } ) ; 
 	 	 	 } 
 	 	 ) ; 
 
 	 } ; 
 
 	 j $ ( d o c u m e n t ) . b i n d ( ' r e f e r r a l L i n k ' ,   h a n d l e R e f e r r a l L i n k ) ; 
 	 j $ ( d o c u m e n t ) . b i n d ( ' r e f e r r a l _ l i n k _ m o d a l _ i n i t ' ,   h a n d l e R e f e r r a l L i n k M o d a l I n i t i a l i z e ) ; 
 	 - - - -   * / 
 
 } ) ( j Q u e r y ) ;    D       https://talent.rakuten.careers/referral.js?v=apptss.2017.PRD.4.2.17     Œ      Œ                    ‚    š    ç Q™¨˜®€ Ð­˜¬€ Ð˜    jQuery‡!«!ÿÿÿÿ            «+’H!«!        C  Ò        ¢                         3          € É  	Œ  Á  	Œ         	          G‚    W   Q‚   W  Q‚   ‰   Q‚   ‰   Qˆ   š    : ¸   
=   V   ç Qˆ   š    : ¸   
=   V  ç Qˆ   š    : ¸   
=   ˆ   ç Q‚   W  Q‚   W  Q‚   ‰   Qˆ   š    : ¸   
=   V  ç Qˆ   š    : ¸   
=   V  ç Q‚   W  Q‚   W  Qˆ   š    : ¸   
=   V  ç Qˆ   š    : ¸   
=   V  ç Q‚	   W  Q‚
   W  Q‚   W  Qˆ   š    : ¸   
=	   V  ç Qˆ   š    : ¸   
=
   V  ç Qˆ   š    : ¸   
=   V  ç Q™©˜Ê¨4˜Ê¨~˜Ë¨€  ¯˜Ë¨€  ×˜Þ˜¤˜Þ˜¤˜ß˜¤ ˜Ê¨€ ˜Ê¨€ Ö˜Ë¨€ ù˜Þ˜¤˜Þ˜¤ ˜Ê¨€ ˜Ê¨€ :˜Þ˜¤˜Þ˜¤   ˜Ê¨€ Y˜Ê¨€ ^˜Ê¨€ †˜Þ˜¤˜Þ˜¤˜Þ˜¬€ Ð    document	   bind   statusUpdate1   status_update_modal_init'   refreshUserBindings   linkedinMessage7   linkedin_message_modal_init   facebookMessage%   facebookSendDialog   weiboStatus#   weiboStatusDialog/   weibo_status_modal_initŒ!«!ÿÿÿÿ      j$%   handleStatusUpdateC   handleStatusUpdateModalInitialize+   refreshStatusBindings1   handleStatusUpdateSubmit+   handleLinkedinMessageI   handleLinkedinMessageModalInitialize7   handleLinkedInMessageSubmit+   handleFacebookMessage1   handleFacebookSendDialog/   handleWeiboStatusUpdate/   handleWeiboStatusDialog7   handleWeiboStatusInitialize   	   «+’H!«!       %   handleStatusUpdateB ò  &  ê  &     "   @       	   data   B  F  w  >  w  $   $          Ê5ž    B  ¶  †  ®  †  %   =           Ê5žÊ5ž!«!       C   handleStatusUpdateModalInitializeB [  æ  S  æ  4   1   0          modal    updateCharCount   B  	  =  	  =  ?       P       Ê5ž    B ó  á  ë  á  [             Ê5ž    B õ  I  í  I  k             Ê5ž    B  Ù    Ñ    r   +          Ê5ž    B   á  w  á  z   ,          Ê5ž Ê5ž!«!       +   refreshStatusBindingsB   ö    ö  ~   %              B R  Å  J  Å  …             Ê5ž    B  Ù  ­  Ñ  ­  ‰      "       Ê5ž   B  #  \    \  ”   "   @         B    O  ÿ  O  œ   :          Ê5ž    B  s  »  k  »  ¡   >          Ê5ž Ê5žÊ5ž!«!       1   handleStatusUpdateSubmitB "          ¯   (           #   broadcastChannels    B  o  ¢  g  ¢  µ   G          Ê5ž    B `  o  X  o  Å      0          B      ú    Ê             Ê5ž Ê5ž   B ƒ  ×  {  ×  Ð             Ê5ž    B  î    æ    Ñ             Ê5ž Ê5ž!«!       +   handleLinkedinMessageB   *    *  Û   %   `       	   data    B  ¨   Ü       Ü   ã   $          Ê5ž    B  !  ò!  !  ò!  ä   ?           Ê5ž   B  o#  £#  g#  £#  ò   $          Ê5ž    B  ä#  y$  Ü#  y$  ó   ?          Ê5ž    B  Ü%  *  Ô%  *  þ                B  &  Ã&  ‡&  Ã&    &          Ê5ž    B  '  ¥'  þ&  ¥'    A          Ê5ž    B y(  û(  q(  û(    F          Ê5ž    B C)  Ä)  ;)  Ä)    E          Ê5ž Ê5žÊ5ž!«!       I   handleLinkedinMessageModalInitializeB Å*  ¤g  ½*  ¤g    4            modal    contacts    contactsList    snapTimer    slideToSnap /   createUserSearchResults    resetPopover #   bindSuggestToggle    resizeMessage )   pushSuggestedContact    readyForMore !   loadMoreContacts %   isScrolledIntoView    B d-  °-  \-  °-  0  3          Ê5ž    B  .  /.  ù-  /.  5  +          Ê5ž    B  ƒ/  ™0  {/  ™0  E  "   0       Ê5ž    B  ò0  2  ê0  2  Q  2             B x1  2  p1  2  U  $             B  ®1  ò1  ¦1  ò1  V  0          Ê5ž Ê5žÊ5ž   B y2  ç2  q2  ç2  _  1             B  Á2  Ü2  ¹2  Ü2  a  "          Ê5ž Ê5ž      slideToSnap  $3  ß4  3  ß4  g     @          prevPos    currPos 	   dest    B µ3  Ù4  ­3  Ù4  i  D   0       Ê5ž Ê5ž   B [5  Š5  S5  Š5  v  *          Ê5ž    B 7  /9  7  /9  ‚             	   data   B  Î8  "9  Æ8  "9              Ê5ž Ê5ž   B C9  —9  ;9  —9  ’            Ê5ž    B  :  ?  ø9  ?  –  :   @          params   B >  k>  >  k>  ²            Ê5ž    B –>  ê>  Ž>  ê>  ¶            Ê5ž    B  ?  ?  ú>  ?  ·            Ê5ž Ê5ž   B X?  µC  P?  µC  »  (             B  ’@  ð@  Š@  ð@  ¿  /          Ê5ž Ê5ž   B  ÕC  iD  ÍC  iD  Ñ            Ê5ž    B  žD  ™K  –D  ™K  ×  2             B  E  ’K  E  ’K  Ù  <   "         B  :E  †E  2E  †E  Ú  "          Ê5ž    B F  \F  F  \F  ß  6          Ê5ž    B •F  `K  F  `K  ã  6   "          event    B  œI  :J  ”I  :J  ò  K          Ê5ž    B  tJ  ¶J  lJ  ¶J  ö  7          Ê5ž    B èJ  WK  àJ  WK  ú  /           Ê5žÊ5žÊ5žÊ5ž   B hM  N  `M  N              Ê5ž    B N  yN  N  yN              Ê5ž    B  ¢N  sP  šN  sP    "             B  ÎN  mP  ÆN  mP    '             B  ;P  fP  3P  fP  #  a          Ê5ž Ê5žÊ5ž   B  °P  R  ¨P  R  *               B €Q  îQ  wQ  îQ  -  (          Ê5ž Ê5ž   B jR  NW  bR  NW  5  %   @          parsed_values    contact_exists    B  (S  ÎS   S  ÎS  8     "       Ê5ž   B ÈT  ýU  ÀT  ýU  ?  8              event    B ,U  ¤U  #U  ¤U  B              Ê5žÊ5ž   B âV  /W  ÚV  /W  M  G          Ê5ž Ê5ž   B X  Ø[  X  Ø[  [     0       Ê5ž    B t\  I_  l\  I_  }                INcontacts   B Ç]  9^  ¿]  9^  „  /           Ê5žÊ5ž   B ^_  „_  V_  „_  ’            Ê5ž    B š_  D`  ’_  D`  •            Ê5ž    B  `  ma  ˜`  ma  Ÿ     "       Ê5ž   B  €a  ºa  xa  ºa  ¦            Ê5ž    !   loadMoreContacts  `b  _f  Gb  _f  ¯     P          pageIndex    params   B Ùc  Ye  Ñc  Ye  ·            Ê5ž    B †e  Úe  ~e  Úe  Ã            Ê5ž Ê5ž   %   isScrolledIntoView f  žg  df  žg  Ì            Ê5ž Ê5ž!«!       7   handleLinkedInMessageSubmitB Óg   l  Ëg   l  Ö  +            B <j  Ok  4j  Ok  ç     0          B  Þj  ýj  Öj  ýj  ì            Ê5ž Ê5ž   B ck  ·k  [k  ·k  ò            Ê5ž    B  Îk  ÷k  Æk  ÷k  ó            Ê5ž Ê5ž!«!       +   handleFacebookMessageB Àl  8p  ¸l  8p  ü  %   @       	   data    B  n  Ln  n  Ln    $          Ê5ž    B  n  bo  …n  bo    ?           Ê5ž   B  ño  /p  éo  /p    /          Ê5ž Ê5ž!«!       1   handleFacebookSendDialogB dp  ïu  \p  ïu    (   @       	   data   B s  ¾u  s  ¾u  #     0       Ê5ž Ê5ž!«!       /   handleWeiboStatusUpdateB ¡v  "z  ™v  "z  ?  '   @       	   data    B  x  @x  x  @x  G  $          Ê5ž    B  ~x  My  vx  My  H  <           Ê5ž   B  Üy  z  Ôy  z  S  /          Ê5ž Ê5ž!«!       /   handleWeiboStatusDialogB Mz  £z  Ez  £z  Y  '          Ê5ž!«!       7   handleWeiboStatusInitializeB Òz  n‚  Êz  n‚  ^  +   0       	   data    current_url    B "}  P}  }  P}  j            Ê5ž    B †}  i‚  ~}  i‚  n  0          Ê5ž Ê5žš˜;øÊ5žš˜;ønüûÝÎ!      \Z¹\Z¹@!9^9 ã   D    :https://talent.rakuten.careers/referral.js?v=apptss.2017.PRD.4.2.17 necko:classified 1 strongly-framed 1 security-info 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 request-method GET response-head HTTP/1.1 200 OK
Date: Mon, 04 Feb 2019 05:28:03 GMT
Server: Taleo Web Server 8
Last-Modified: Wed, 05 Sep 2018 07:18:14 GMT
Accept-Ranges: bytes
Content-Length: 35859
Cache-Control: max-age=31536000
Expires: Tue, 04 Feb 2020 05:28:03 GMT
Content-Type: application/javascript
 original-response-headers Date: Mon, 04 Feb 2019 05:28:03 GMT
Server: Taleo Web Server 8
Last-Modified: Wed, 05 Sep 2018 07:18:14 GMT
Accept-Ranges: bytes
Content-Length: 35859
Cache-Control: max-age=31536000
Expires: Tue, 04 Feb 2020 05:28:03 GMT
Keep-Alive: timeout=5, max=99
Connection: Keep-Alive
Content-Type: application/javascript
 uncompressed-len 0 net-response-time-onstart 218 net-response-time-onstop 432 alt-data 1;35859,javascript/moz-bytecode-20190128165852 alt-data-from-child 1  ÁI